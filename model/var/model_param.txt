# Unet
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
UNet                                     --
├─DoubleConv: 1-1                        --
│    └─Conv2d: 2-1                       896
│    └─ReLU: 2-2                         --
│    └─BatchNorm2d: 2-3                  64
│    └─Sequential: 2-4                   960
│    │    └─Conv2d: 3-1                  (recursive)
│    │    └─BatchNorm2d: 3-2             (recursive)
│    │    └─ReLU: 3-3                    --
│    └─Conv2d: 2-5                       9,248
│    └─BatchNorm2d: 2-6                  64
│    └─Sequential: 2-7                   9,312
│    │    └─Conv2d: 3-4                  (recursive)
│    │    └─BatchNorm2d: 3-5             (recursive)
│    │    └─ReLU: 3-6                    --
├─Down: 1-2                              --
│    └─MaxPool2d: 2-8                    --
│    └─DoubleConv: 2-9                   --
│    │    └─Conv2d: 3-7                  18,496
│    │    └─ReLU: 3-8                    --
│    │    └─BatchNorm2d: 3-9             128
│    │    └─Sequential: 3-10             18,624
│    │    └─Conv2d: 3-11                 36,928
│    │    └─BatchNorm2d: 3-12            128
│    │    └─Sequential: 3-13             37,056
├─Down: 1-3                              --
│    └─MaxPool2d: 2-10                   --
│    └─DoubleConv: 2-11                  --
│    │    └─Conv2d: 3-14                 73,856
│    │    └─ReLU: 3-15                   --
│    │    └─BatchNorm2d: 3-16            256
│    │    └─Sequential: 3-17             74,112
│    │    └─Conv2d: 3-18                 147,584
│    │    └─BatchNorm2d: 3-19            256
│    │    └─Sequential: 3-20             147,840
├─Down: 1-4                              --
│    └─MaxPool2d: 2-12                   --
│    └─DoubleConv: 2-13                  --
│    │    └─Conv2d: 3-21                 295,168
│    │    └─ReLU: 3-22                   --
│    │    └─BatchNorm2d: 3-23            512
│    │    └─Sequential: 3-24             295,680
│    │    └─Conv2d: 3-25                 590,080
│    │    └─BatchNorm2d: 3-26            512
│    │    └─Sequential: 3-27             590,592
├─MaxPool2d: 1-5                         --
├─Dropout2d: 1-6                         --
├─DoubleConv: 1-7                        --
│    └─Conv2d: 2-14                      1,180,160
│    └─ReLU: 2-15                        --
│    └─BatchNorm2d: 2-16                 1,024
│    └─Sequential: 2-17                  1,181,184
│    │    └─Conv2d: 3-28                 (recursive)
│    │    └─BatchNorm2d: 3-29            (recursive)
│    │    └─ReLU: 3-30                   --
│    └─Conv2d: 2-18                      1,179,904
│    └─BatchNorm2d: 2-19                 512
│    └─Sequential: 2-20                  1,180,416
│    │    └─Conv2d: 3-31                 (recursive)
│    │    └─BatchNorm2d: 3-32            (recursive)
│    │    └─ReLU: 3-33                   --
├─Up: 1-8                                --
│    └─Upsample: 2-21                    --
│    └─DoubleConv: 2-22                  --
│    │    └─Conv2d: 3-34                 589,952
│    │    └─ReLU: 3-35                   --
│    │    └─BatchNorm2d: 3-36            256
│    │    └─Sequential: 3-37             590,208
│    │    └─Conv2d: 3-38                 147,584
│    │    └─BatchNorm2d: 3-39            256
│    │    └─Sequential: 3-40             147,840
├─Up: 1-9                                --
│    └─Upsample: 2-23                    --
│    └─DoubleConv: 2-24                  --
│    │    └─Conv2d: 3-41                 147,520
│    │    └─ReLU: 3-42                   --
│    │    └─BatchNorm2d: 3-43            128
│    │    └─Sequential: 3-44             147,648
│    │    └─Conv2d: 3-45                 36,928
│    │    └─BatchNorm2d: 3-46            128
│    │    └─Sequential: 3-47             37,056
├─Up: 1-10                               --
│    └─Upsample: 2-25                    --
│    └─DoubleConv: 2-26                  --
│    │    └─Conv2d: 3-48                 36,896
│    │    └─ReLU: 3-49                   --
│    │    └─BatchNorm2d: 3-50            64
│    │    └─Sequential: 3-51             36,960
│    │    └─Conv2d: 3-52                 9,248
│    │    └─BatchNorm2d: 3-53            64
│    │    └─Sequential: 3-54             9,312
├─Up: 1-11                               --
│    └─Upsample: 2-27                    --
│    └─DoubleConv: 2-28                  --
│    │    └─Conv2d: 3-55                 9,232
│    │    └─ReLU: 3-56                   --
│    │    └─BatchNorm2d: 3-57            32
│    │    └─Sequential: 3-58             9,264
│    │    └─Conv2d: 3-59                 4,640
│    │    └─BatchNorm2d: 3-60            64
│    │    └─Sequential: 3-61             4,704
├─OutConv: 1-12                          --
│    └─Conv2d: 2-29                      132
=================================================================
Total params: 9,037,668
Trainable params: 9,037,668
Non-trainable params: 0
=================================================================

"""
ResD_unet:base_channels=32; tripleconv
"""
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
ResD_UNet                                [1, 4, 224, 224]          --
├─DoubleConv: 1-1                        [1, 32, 224, 224]         --
│    └─Sequential: 2-1                   [1, 32, 224, 224]         --
│    │    └─Conv2d: 3-1                  [1, 32, 224, 224]         896
│    │    └─BatchNorm2d: 3-2             [1, 32, 224, 224]         64
│    └─Sequential: 2-2                   --                        (recursive)
│    │    └─ReLU: 3-3                    [1, 32, 224, 224]         --
│    └─Sequential: 2-3                   [1, 32, 224, 224]         --
│    │    └─Conv2d: 3-4                  [1, 32, 224, 224]         9,248
│    │    └─BatchNorm2d: 3-5             [1, 32, 224, 224]         64
│    │    └─ReLU: 3-6                    [1, 32, 224, 224]         --
├─ResD_Down: 1-2                         [1, 64, 112, 112]         --
│    └─MaxPool2d: 2-4                    [1, 32, 112, 112]         --
│    └─Dalit_Conv: 2-5                   [1, 64, 112, 112]         --
│    │    └─Sequential: 3-7              [1, 64, 112, 112]         18,624
│    │    └─Sequential: 3-10             --                        (recursive)
│    │    └─Sequential: 3-9              [1, 64, 112, 112]         37,056
│    │    └─Sequential: 3-10             --                        (recursive)
│    │    └─Sequential: 3-11             [1, 64, 112, 112]         37,056
│    └─ResConv: 2-6                      [1, 64, 112, 112]         --
│    │    └─Sequential: 3-12             [1, 64, 112, 112]         4,288
│    │    └─Sequential: 3-13             [1, 32, 112, 112]         2,144
│    │    └─Sequential: 3-18             --                        (recursive)
│    │    └─Sequential: 3-15             [1, 32, 112, 112]         9,312
│    │    └─Sequential: 3-16             [1, 64, 112, 112]         2,240
│    │    └─Sequential: 3-17             --                        (recursive)
│    │    └─Sequential: 3-18             --                        (recursive)
├─Dropout2d: 1-3                         [1, 64, 112, 112]         --
├─Res_Down: 1-4                          [1, 128, 56, 56]          --
│    └─MaxPool2d: 2-7                    [1, 64, 56, 56]           --
│    └─ResConv: 2-8                      [1, 128, 56, 56]          --
│    │    └─Sequential: 3-19             [1, 128, 56, 56]          8,576
│    │    └─Sequential: 3-20             [1, 32, 56, 56]           2,144
│    │    └─Sequential: 3-25             --                        (recursive)
│    │    └─Sequential: 3-22             [1, 32, 56, 56]           9,312
│    │    └─Sequential: 3-23             [1, 128, 56, 56]          4,480
│    │    └─Sequential: 3-24             --                        (recursive)
│    │    └─Sequential: 3-25             --                        (recursive)
├─Dropout2d: 1-5                         [1, 128, 56, 56]          --
├─Res_Down: 1-6                          [1, 256, 28, 28]          --
│    └─MaxPool2d: 2-9                    [1, 128, 28, 28]          --
│    └─ResConv: 2-10                     [1, 256, 28, 28]          --
│    │    └─Sequential: 3-26             [1, 256, 28, 28]          33,536
│    │    └─Sequential: 3-27             [1, 64, 28, 28]           8,384
│    │    └─Sequential: 3-32             --                        (recursive)
│    │    └─Sequential: 3-29             [1, 64, 28, 28]           37,056
│    │    └─Sequential: 3-30             [1, 256, 28, 28]          17,152
│    │    └─Sequential: 3-31             --                        (recursive)
│    │    └─Sequential: 3-32             --                        (recursive)
├─Dropout2d: 1-7                         [1, 256, 28, 28]          --
├─Res_Down: 1-8                          [1, 256, 14, 14]          --
│    └─MaxPool2d: 2-11                   [1, 256, 14, 14]          --
│    └─ResConv: 2-12                     [1, 256, 14, 14]          --
│    │    └─Sequential: 3-33             [1, 256, 14, 14]          66,304
│    │    └─Sequential: 3-34             [1, 64, 14, 14]           16,576
│    │    └─Sequential: 3-39             --                        (recursive)
│    │    └─Sequential: 3-36             [1, 64, 14, 14]           37,056
│    │    └─Sequential: 3-37             [1, 256, 14, 14]          17,152
│    │    └─Sequential: 3-38             --                        (recursive)
│    │    └─Sequential: 3-39             --                        (recursive)
├─Dropout2d: 1-9                         [1, 256, 14, 14]          --
├─DoubleConv: 1-10                       [1, 512, 14, 14]          --
│    └─Sequential: 2-13                  [1, 512, 14, 14]          --
│    │    └─Conv2d: 3-40                 [1, 512, 14, 14]          1,180,160
│    │    └─BatchNorm2d: 3-41            [1, 512, 14, 14]          1,024
│    └─Sequential: 2-14                  --                        (recursive)
│    │    └─ReLU: 3-42                   [1, 512, 14, 14]          --
│    └─Sequential: 2-15                  [1, 512, 14, 14]          --
│    │    └─Conv2d: 3-43                 [1, 512, 14, 14]          2,359,808
│    │    └─BatchNorm2d: 3-44            [1, 512, 14, 14]          1,024
│    │    └─ReLU: 3-45                   [1, 512, 14, 14]          --
├─Res_Up: 1-11                           [1, 128, 28, 28]          --
│    └─Upsample: 2-16                    [1, 256, 28, 28]          --
│    └─ResConv: 2-17                     [1, 128, 28, 28]          --
│    │    └─Sequential: 3-46             [1, 128, 28, 28]          65,920
│    │    └─Sequential: 3-47             [1, 128, 28, 28]          65,920
│    │    └─Sequential: 3-52             --                        (recursive)
│    │    └─Sequential: 3-49             [1, 128, 28, 28]          147,840
│    │    └─Sequential: 3-50             [1, 128, 28, 28]          16,768
│    │    └─Sequential: 3-51             --                        (recursive)
│    │    └─Sequential: 3-52             --                        (recursive)
├─Dropout2d: 1-12                        [1, 128, 28, 28]          --
├─Res_Up: 1-13                           [1, 64, 56, 56]           --
│    └─Upsample: 2-18                    [1, 128, 56, 56]          --
│    └─ResConv: 2-19                     [1, 64, 56, 56]           --
│    │    └─Sequential: 3-53             [1, 64, 56, 56]           16,576
│    │    └─Sequential: 3-54             [1, 64, 56, 56]           16,576
│    │    └─Sequential: 3-59             --                        (recursive)
│    │    └─Sequential: 3-56             [1, 64, 56, 56]           37,056
│    │    └─Sequential: 3-57             [1, 64, 56, 56]           4,288
│    │    └─Sequential: 3-58             --                        (recursive)
│    │    └─Sequential: 3-59             --                        (recursive)
├─Dropout2d: 1-14                        [1, 64, 56, 56]           --
├─Res_Up: 1-15                           [1, 32, 112, 112]         --
│    └─Upsample: 2-20                    [1, 64, 112, 112]         --
│    └─ResConv: 2-21                     [1, 32, 112, 112]         --
│    │    └─Sequential: 3-60             [1, 32, 112, 112]         4,192
│    │    └─Sequential: 3-61             [1, 2, 112, 112]          262
│    │    └─Sequential: 3-66             --                        (recursive)
│    │    └─Sequential: 3-63             [1, 2, 112, 112]          42
│    │    └─Sequential: 3-64             [1, 32, 112, 112]         160
│    │    └─Sequential: 3-65             --                        (recursive)
│    │    └─Sequential: 3-66             --                        (recursive)
├─Dropout2d: 1-16                        [1, 32, 112, 112]         --
├─ResD_Up: 1-17                          [1, 32, 224, 224]         --
│    └─Upsample: 2-22                    [1, 32, 224, 224]         --
│    └─Dalit_Conv: 2-23                  [1, 32, 224, 224]         --
│    │    └─Sequential: 3-67             [1, 32, 224, 224]         18,528
│    │    └─Sequential: 3-70             --                        (recursive)
│    │    └─Sequential: 3-69             [1, 32, 224, 224]         9,312
│    │    └─Sequential: 3-70             --                        (recursive)
│    │    └─Sequential: 3-71             [1, 32, 224, 224]         9,312
│    └─ResConv: 2-24                     [1, 32, 224, 224]         --
│    │    └─Sequential: 3-72             [1, 32, 224, 224]         1,120
│    │    └─Sequential: 3-73             [1, 16, 224, 224]         560
│    │    └─Sequential: 3-78             --                        (recursive)
│    │    └─Sequential: 3-75             [1, 16, 224, 224]         2,352
│    │    └─Sequential: 3-76             [1, 32, 224, 224]         608
│    │    └─Sequential: 3-77             --                        (recursive)
│    │    └─Sequential: 3-78             --                        (recursive)
├─Dropout2d: 1-18                        [1, 32, 224, 224]         --
├─OutConv: 1-19                          [1, 4, 224, 224]          --
│    └─Conv2d: 2-25                      [1, 4, 224, 224]          132
==========================================================================================
Total params: 4,338,260
Trainable params: 4,338,260
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 5.36
==========================================================================================
Input size (MB): 0.60
Forward/backward pass size (MB): 346.42
Params size (MB): 17.35
Estimated Total Size (MB): 364.36
==========================================================================================

# SED_unet  增加了金字塔池化
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
SED_UNet                                      [1, 4, 224, 224]          --
├─DoubleConv: 1-1                             [1, 32, 224, 224]         --
│    └─Sequential: 2-1                        [1, 32, 224, 224]         --
│    │    └─Conv2d: 3-1                       [1, 32, 224, 224]         896
│    │    └─BatchNorm2d: 3-2                  [1, 32, 224, 224]         64
│    └─Sequential: 2-2                        --                        (recursive)
│    │    └─ReLU: 3-3                         [1, 32, 224, 224]         --
│    └─Sequential: 2-3                        [1, 32, 224, 224]         --
│    │    └─Conv2d: 3-4                       [1, 32, 224, 224]         9,248
│    │    └─BatchNorm2d: 3-5                  [1, 32, 224, 224]         64
│    │    └─ReLU: 3-6                         [1, 32, 224, 224]         --
├─Dropout2d: 1-2                              [1, 32, 224, 224]         --
├─PSPModule: 1-3                              [1, 64, 224, 224]         --
│    └─ModuleList: 2-4                        --                        --
│    │    └─Sequential: 3-7                   [1, 8, 16, 16]            280
│    │    └─Sequential: 3-8                   [1, 8, 32, 32]            280
│    │    └─Sequential: 3-9                   [1, 8, 64, 64]            280
│    │    └─Sequential: 3-10                  [1, 8, 128, 128]          280
├─Dropout2d: 1-4                              [1, 64, 224, 224]         --
├─DoubleConv: 1-5                             [1, 32, 224, 224]         --
│    └─Sequential: 2-5                        [1, 32, 224, 224]         --
│    │    └─Conv2d: 3-11                      [1, 32, 224, 224]         18,464
│    │    └─BatchNorm2d: 3-12                 [1, 32, 224, 224]         64
│    └─Sequential: 2-6                        --                        (recursive)
│    │    └─ReLU: 3-13                        [1, 32, 224, 224]         --
│    └─Sequential: 2-7                        [1, 32, 224, 224]         --
│    │    └─Conv2d: 3-14                      [1, 32, 224, 224]         9,248
│    │    └─BatchNorm2d: 3-15                 [1, 32, 224, 224]         64
│    │    └─ReLU: 3-16                        [1, 32, 224, 224]         --
├─Down: 1-6                                   [1, 64, 112, 112]         --
│    └─MaxPool2d: 2-8                         [1, 32, 112, 112]         --
│    └─DoubleConv: 2-9                        [1, 64, 112, 112]         --
│    │    └─Sequential: 3-17                  [1, 64, 112, 112]         18,624
│    │    └─Sequential: 3-18                  --                        (recursive)
│    │    └─Sequential: 3-19                  [1, 64, 112, 112]         37,056
├─Dropout2d: 1-7                              [1, 64, 112, 112]         --
├─Down: 1-8                                   [1, 128, 56, 56]          --
│    └─MaxPool2d: 2-10                        [1, 64, 56, 56]           --
│    └─DoubleConv: 2-11                       [1, 128, 56, 56]          --
│    │    └─Sequential: 3-20                  [1, 128, 56, 56]          74,112
│    │    └─Sequential: 3-21                  --                        (recursive)
│    │    └─Sequential: 3-22                  [1, 128, 56, 56]          147,840
├─Dropout2d: 1-9                              [1, 128, 56, 56]          --
├─Down: 1-10                                  [1, 256, 28, 28]          --
│    └─MaxPool2d: 2-12                        [1, 128, 28, 28]          --
│    └─DoubleConv: 2-13                       [1, 256, 28, 28]          --
│    │    └─Sequential: 3-23                  [1, 256, 28, 28]          295,680
│    │    └─Sequential: 3-24                  --                        (recursive)
│    │    └─Sequential: 3-25                  [1, 256, 28, 28]          590,592
├─Dropout2d: 1-11                             [1, 256, 28, 28]          --
├─Down: 1-12                                  [1, 256, 14, 14]          --
│    └─MaxPool2d: 2-14                        [1, 256, 14, 14]          --
│    └─DoubleConv: 2-15                       [1, 256, 14, 14]          --
│    │    └─Sequential: 3-26                  [1, 256, 14, 14]          590,592
│    │    └─Sequential: 3-27                  --                        (recursive)
│    │    └─Sequential: 3-28                  [1, 256, 14, 14]          590,592
├─Dropout2d: 1-13                             [1, 256, 14, 14]          --
├─DoubleConv: 1-14                            [1, 512, 14, 14]          --
│    └─Sequential: 2-16                       [1, 512, 14, 14]          --
│    │    └─Conv2d: 3-29                      [1, 512, 14, 14]          1,180,160
│    │    └─BatchNorm2d: 3-30                 [1, 512, 14, 14]          1,024
│    └─Sequential: 2-17                       --                        (recursive)
│    │    └─ReLU: 3-31                        [1, 512, 14, 14]          --
│    └─Sequential: 2-18                       [1, 512, 14, 14]          --
│    │    └─Conv2d: 3-32                      [1, 512, 14, 14]          2,359,808
│    │    └─BatchNorm2d: 3-33                 [1, 512, 14, 14]          1,024
│    │    └─ReLU: 3-34                        [1, 512, 14, 14]          --
├─Up: 1-15                                    [1, 128, 28, 28]          --
│    └─Upsample: 2-19                         [1, 256, 28, 28]          --
│    └─DoubleConv: 2-20                       [1, 128, 28, 28]          --
│    │    └─Sequential: 3-35                  [1, 256, 28, 28]          1,180,416
│    │    └─Sequential: 3-36                  --                        (recursive)
│    │    └─Sequential: 3-37                  [1, 128, 28, 28]          295,296
├─Dropout2d: 1-16                             [1, 128, 28, 28]          --
├─Up: 1-17                                    [1, 64, 56, 56]           --
│    └─Upsample: 2-21                         [1, 128, 56, 56]          --
│    └─DoubleConv: 2-22                       [1, 64, 56, 56]           --
│    │    └─Sequential: 3-38                  [1, 128, 56, 56]          295,296
│    │    └─Sequential: 3-39                  --                        (recursive)
│    │    └─Sequential: 3-40                  [1, 64, 56, 56]           73,920
├─Dropout2d: 1-18                             [1, 64, 56, 56]           --
├─Up: 1-19                                    [1, 32, 112, 112]         --
│    └─Upsample: 2-23                         [1, 64, 112, 112]         --
│    └─DoubleConv: 2-24                       [1, 32, 112, 112]         --
│    │    └─Sequential: 3-41                  [1, 64, 112, 112]         73,920
│    │    └─Sequential: 3-42                  --                        (recursive)
│    │    └─Sequential: 3-43                  [1, 32, 112, 112]         18,528
├─Dropout2d: 1-20                             [1, 32, 112, 112]         --
├─Up: 1-21                                    [1, 32, 224, 224]         --
│    └─Upsample: 2-25                         [1, 32, 224, 224]         --
│    └─DoubleConv: 2-26                       [1, 32, 224, 224]         --
│    │    └─Sequential: 3-44                  [1, 32, 224, 224]         18,528
│    │    └─Sequential: 3-45                  --                        (recursive)
│    │    └─Sequential: 3-46                  [1, 32, 224, 224]         9,312
├─Dropout2d: 1-22                             [1, 32, 224, 224]         --
├─OutConv: 1-23                               [1, 4, 224, 224]          --
│    └─Conv2d: 2-27                           [1, 4, 224, 224]          132
===============================================================================================
Total params: 7,891,684
Trainable params: 7,891,684
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 9.78
===============================================================================================
Input size (MB): 0.60
Forward/backward pass size (MB): 242.02
Params size (MB): 31.57
Estimated Total Size (MB): 274.19
===============================================================================================

## res_101 pspnet
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
PSPNet                                             --
├─Dropout2d: 1-1                                   --
├─Sequential: 1-2                                  --
│    └─ConvBNReluLayer: 2-1                        --
│    │    └─Conv2d: 3-1                            9,472
│    │    └─BatchNorm2d: 3-2                       128
│    │    └─ReLU: 3-3                              --
│    └─MaxPool2d: 2-2                              --
├─Sequential: 1-3                                  --
│    └─BottleneckBlock: 2-3                        --
│    │    └─ConvBNReluLayer: 3-4                   4,288
│    │    └─ConvBNReluLayer: 3-5                   37,056
│    │    └─ConvBNReluLayer: 3-6                   17,152
│    │    └─ConvBNReluLayer: 3-7                   17,152
│    └─BottleneckBlock: 2-4                        --
│    │    └─ConvBNReluLayer: 3-8                   16,576
│    │    └─ConvBNReluLayer: 3-9                   37,056
│    │    └─ConvBNReluLayer: 3-10                  17,152
│    └─BottleneckBlock: 2-5                        --
│    │    └─ConvBNReluLayer: 3-11                  16,576
│    │    └─ConvBNReluLayer: 3-12                  37,056
│    │    └─ConvBNReluLayer: 3-13                  17,152
├─Sequential: 1-4                                  --
│    └─BottleneckBlock: 2-6                        --
│    │    └─ConvBNReluLayer: 3-14                  33,152
│    │    └─ConvBNReluLayer: 3-15                  147,840
│    │    └─ConvBNReluLayer: 3-16                  67,072
│    │    └─ConvBNReluLayer: 3-17                  132,608
│    └─BottleneckBlock: 2-7                        --
│    │    └─ConvBNReluLayer: 3-18                  65,920
│    │    └─ConvBNReluLayer: 3-19                  147,840
│    │    └─ConvBNReluLayer: 3-20                  67,072
│    └─BottleneckBlock: 2-8                        --
│    │    └─ConvBNReluLayer: 3-21                  65,920
│    │    └─ConvBNReluLayer: 3-22                  147,840
│    │    └─ConvBNReluLayer: 3-23                  67,072
│    └─BottleneckBlock: 2-9                        --
│    │    └─ConvBNReluLayer: 3-24                  65,920
│    │    └─ConvBNReluLayer: 3-25                  147,840
│    │    └─ConvBNReluLayer: 3-26                  67,072
├─Sequential: 1-5                                  --
│    └─BottleneckBlock: 2-10                       --
│    │    └─ConvBNReluLayer: 3-27                  131,840
│    │    └─ConvBNReluLayer: 3-28                  590,592
│    │    └─ConvBNReluLayer: 3-29                  265,216
│    │    └─ConvBNReluLayer: 3-30                  527,360
│    └─BottleneckBlock: 2-11                       --
│    │    └─ConvBNReluLayer: 3-31                  262,912
│    │    └─ConvBNReluLayer: 3-32                  590,592
│    │    └─ConvBNReluLayer: 3-33                  265,216
│    └─BottleneckBlock: 2-12                       --
│    │    └─ConvBNReluLayer: 3-34                  262,912
│    │    └─ConvBNReluLayer: 3-35                  590,592
│    │    └─ConvBNReluLayer: 3-36                  265,216
│    └─BottleneckBlock: 2-13                       --
│    │    └─ConvBNReluLayer: 3-37                  262,912
│    │    └─ConvBNReluLayer: 3-38                  590,592
│    │    └─ConvBNReluLayer: 3-39                  265,216
│    └─BottleneckBlock: 2-14                       --
│    │    └─ConvBNReluLayer: 3-40                  262,912
│    │    └─ConvBNReluLayer: 3-41                  590,592
│    │    └─ConvBNReluLayer: 3-42                  265,216
│    └─BottleneckBlock: 2-15                       --
│    │    └─ConvBNReluLayer: 3-43                  262,912
│    │    └─ConvBNReluLayer: 3-44                  590,592
│    │    └─ConvBNReluLayer: 3-45                  265,216
│    └─BottleneckBlock: 2-16                       --
│    │    └─ConvBNReluLayer: 3-46                  262,912
│    │    └─ConvBNReluLayer: 3-47                  590,592
│    │    └─ConvBNReluLayer: 3-48                  265,216
│    └─BottleneckBlock: 2-17                       --
│    │    └─ConvBNReluLayer: 3-49                  262,912
│    │    └─ConvBNReluLayer: 3-50                  590,592
│    │    └─ConvBNReluLayer: 3-51                  265,216
│    └─BottleneckBlock: 2-18                       --
│    │    └─ConvBNReluLayer: 3-52                  262,912
│    │    └─ConvBNReluLayer: 3-53                  590,592
│    │    └─ConvBNReluLayer: 3-54                  265,216
│    └─BottleneckBlock: 2-19                       --
│    │    └─ConvBNReluLayer: 3-55                  262,912
│    │    └─ConvBNReluLayer: 3-56                  590,592
│    │    └─ConvBNReluLayer: 3-57                  265,216
│    └─BottleneckBlock: 2-20                       --
│    │    └─ConvBNReluLayer: 3-58                  262,912
│    │    └─ConvBNReluLayer: 3-59                  590,592
│    │    └─ConvBNReluLayer: 3-60                  265,216
│    └─BottleneckBlock: 2-21                       --
│    │    └─ConvBNReluLayer: 3-61                  262,912
│    │    └─ConvBNReluLayer: 3-62                  590,592
│    │    └─ConvBNReluLayer: 3-63                  265,216
│    └─BottleneckBlock: 2-22                       --
│    │    └─ConvBNReluLayer: 3-64                  262,912
│    │    └─ConvBNReluLayer: 3-65                  590,592
│    │    └─ConvBNReluLayer: 3-66                  265,216
│    └─BottleneckBlock: 2-23                       --
│    │    └─ConvBNReluLayer: 3-67                  262,912
│    │    └─ConvBNReluLayer: 3-68                  590,592
│    │    └─ConvBNReluLayer: 3-69                  265,216
│    └─BottleneckBlock: 2-24                       --
│    │    └─ConvBNReluLayer: 3-70                  262,912
│    │    └─ConvBNReluLayer: 3-71                  590,592
│    │    └─ConvBNReluLayer: 3-72                  265,216
│    └─BottleneckBlock: 2-25                       --
│    │    └─ConvBNReluLayer: 3-73                  262,912
│    │    └─ConvBNReluLayer: 3-74                  590,592
│    │    └─ConvBNReluLayer: 3-75                  265,216
│    └─BottleneckBlock: 2-26                       --
│    │    └─ConvBNReluLayer: 3-76                  262,912
│    │    └─ConvBNReluLayer: 3-77                  590,592
│    │    └─ConvBNReluLayer: 3-78                  265,216
│    └─BottleneckBlock: 2-27                       --
│    │    └─ConvBNReluLayer: 3-79                  262,912
│    │    └─ConvBNReluLayer: 3-80                  590,592
│    │    └─ConvBNReluLayer: 3-81                  265,216
│    └─BottleneckBlock: 2-28                       --
│    │    └─ConvBNReluLayer: 3-82                  262,912
│    │    └─ConvBNReluLayer: 3-83                  590,592
│    │    └─ConvBNReluLayer: 3-84                  265,216
│    └─BottleneckBlock: 2-29                       --
│    │    └─ConvBNReluLayer: 3-85                  262,912
│    │    └─ConvBNReluLayer: 3-86                  590,592
│    │    └─ConvBNReluLayer: 3-87                  265,216
│    └─BottleneckBlock: 2-30                       --
│    │    └─ConvBNReluLayer: 3-88                  262,912
│    │    └─ConvBNReluLayer: 3-89                  590,592
│    │    └─ConvBNReluLayer: 3-90                  265,216
│    └─BottleneckBlock: 2-31                       --
│    │    └─ConvBNReluLayer: 3-91                  262,912
│    │    └─ConvBNReluLayer: 3-92                  590,592
│    │    └─ConvBNReluLayer: 3-93                  265,216
│    └─BottleneckBlock: 2-32                       --
│    │    └─ConvBNReluLayer: 3-94                  262,912
│    │    └─ConvBNReluLayer: 3-95                  590,592
│    │    └─ConvBNReluLayer: 3-96                  265,216
├─Sequential: 1-6                                  --
│    └─BottleneckBlock: 2-33                       --
│    │    └─ConvBNReluLayer: 3-97                  525,824
│    │    └─ConvBNReluLayer: 3-98                  2,360,832
│    │    └─ConvBNReluLayer: 3-99                  1,054,720
│    │    └─ConvBNReluLayer: 3-100                 2,103,296
│    └─BottleneckBlock: 2-34                       --
│    │    └─ConvBNReluLayer: 3-101                 1,050,112
│    │    └─ConvBNReluLayer: 3-102                 2,360,832
│    │    └─ConvBNReluLayer: 3-103                 1,054,720
│    └─BottleneckBlock: 2-35                       --
│    │    └─ConvBNReluLayer: 3-104                 1,050,112
│    │    └─ConvBNReluLayer: 3-105                 2,360,832
│    │    └─ConvBNReluLayer: 3-106                 1,054,720
├─PSPModule: 1-7                                   --
│    └─ModuleList: 2-36                            --
│    │    └─Sequential: 3-107                      1,050,112
│    │    └─Sequential: 3-108                      1,050,112
│    │    └─Sequential: 3-109                      1,050,112
│    │    └─Sequential: 3-110                      1,050,112
│    └─CausalityMapBlock: 2-37                     --
│    └─CausalityFactorsExtractor: 2-38             --
│    │    └─StraightThroughEstimator: 3-111        --
│    │    └─ReLU: 3-112                            --
│    │    └─Sigmoid: 3-113                         --
├─Sequential: 1-8                                  --
│    └─Conv2d: 2-39                                18,874,880
│    └─BatchNorm2d: 2-40                           1,024
│    └─ReLU: 2-41                                  --
│    └─Dropout: 2-42                               --
│    └─Conv2d: 2-43                                1,539
├─Sequential: 1-9                                  --
│    └─Conv2d: 2-44                                4,719,104
│    └─BatchNorm2d: 2-45                           1,024
│    └─ReLU: 2-46                                  --
│    └─Dropout: 2-47                               --
│    └─Conv2d: 2-48                                1,539
===========================================================================
Total params: 70,352,390
Trainable params: 70,352,390
Non-trainable params: 0
===========================================================================
torch.Size([2, 3, 256, 256])
torch.Size([2, 3, 256, 256])
# pspnet res50:
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
PSPNet                                             --
├─Dropout2d: 1-1                                   --
├─Sequential: 1-2                                  --
│    └─ConvBNReluLayer: 2-1                        --
│    │    └─Conv2d: 3-1                            9,472
│    │    └─BatchNorm2d: 3-2                       128
│    │    └─ReLU: 3-3                              --
│    └─MaxPool2d: 2-2                              --
├─Sequential: 1-3                                  --
│    └─BottleneckBlock: 2-3                        --
│    │    └─ConvBNReluLayer: 3-4                   4,288
│    │    └─ConvBNReluLayer: 3-5                   37,056
│    │    └─ConvBNReluLayer: 3-6                   17,152
│    │    └─ConvBNReluLayer: 3-7                   17,152
│    └─BottleneckBlock: 2-4                        --
│    │    └─ConvBNReluLayer: 3-8                   16,576
│    │    └─ConvBNReluLayer: 3-9                   37,056
│    │    └─ConvBNReluLayer: 3-10                  17,152
│    └─BottleneckBlock: 2-5                        --
│    │    └─ConvBNReluLayer: 3-11                  16,576
│    │    └─ConvBNReluLayer: 3-12                  37,056
│    │    └─ConvBNReluLayer: 3-13                  17,152
├─Sequential: 1-4                                  --
│    └─BottleneckBlock: 2-6                        --
│    │    └─ConvBNReluLayer: 3-14                  33,152
│    │    └─ConvBNReluLayer: 3-15                  147,840
│    │    └─ConvBNReluLayer: 3-16                  67,072
│    │    └─ConvBNReluLayer: 3-17                  132,608
│    └─BottleneckBlock: 2-7                        --
│    │    └─ConvBNReluLayer: 3-18                  65,920
│    │    └─ConvBNReluLayer: 3-19                  147,840
│    │    └─ConvBNReluLayer: 3-20                  67,072
│    └─BottleneckBlock: 2-8                        --
│    │    └─ConvBNReluLayer: 3-21                  65,920
│    │    └─ConvBNReluLayer: 3-22                  147,840
│    │    └─ConvBNReluLayer: 3-23                  67,072
│    └─BottleneckBlock: 2-9                        --
│    │    └─ConvBNReluLayer: 3-24                  65,920
│    │    └─ConvBNReluLayer: 3-25                  147,840
│    │    └─ConvBNReluLayer: 3-26                  67,072
├─Sequential: 1-5                                  --
│    └─BottleneckBlock: 2-10                       --
│    │    └─ConvBNReluLayer: 3-27                  131,840
│    │    └─ConvBNReluLayer: 3-28                  590,592
│    │    └─ConvBNReluLayer: 3-29                  265,216
│    │    └─ConvBNReluLayer: 3-30                  527,360
│    └─BottleneckBlock: 2-11                       --
│    │    └─ConvBNReluLayer: 3-31                  262,912
│    │    └─ConvBNReluLayer: 3-32                  590,592
│    │    └─ConvBNReluLayer: 3-33                  265,216
│    └─BottleneckBlock: 2-12                       --
│    │    └─ConvBNReluLayer: 3-34                  262,912
│    │    └─ConvBNReluLayer: 3-35                  590,592
│    │    └─ConvBNReluLayer: 3-36                  265,216
│    └─BottleneckBlock: 2-13                       --
│    │    └─ConvBNReluLayer: 3-37                  262,912
│    │    └─ConvBNReluLayer: 3-38                  590,592
│    │    └─ConvBNReluLayer: 3-39                  265,216
│    └─BottleneckBlock: 2-14                       --
│    │    └─ConvBNReluLayer: 3-40                  262,912
│    │    └─ConvBNReluLayer: 3-41                  590,592
│    │    └─ConvBNReluLayer: 3-42                  265,216
│    └─BottleneckBlock: 2-15                       --
│    │    └─ConvBNReluLayer: 3-43                  262,912
│    │    └─ConvBNReluLayer: 3-44                  590,592
│    │    └─ConvBNReluLayer: 3-45                  265,216
├─Sequential: 1-6                                  --
│    └─BottleneckBlock: 2-16                       --
│    │    └─ConvBNReluLayer: 3-46                  525,824
│    │    └─ConvBNReluLayer: 3-47                  2,360,832
│    │    └─ConvBNReluLayer: 3-48                  1,054,720
│    │    └─ConvBNReluLayer: 3-49                  2,103,296
│    └─BottleneckBlock: 2-17                       --
│    │    └─ConvBNReluLayer: 3-50                  1,050,112
│    │    └─ConvBNReluLayer: 3-51                  2,360,832
│    │    └─ConvBNReluLayer: 3-52                  1,054,720
│    └─BottleneckBlock: 2-18                       --
│    │    └─ConvBNReluLayer: 3-53                  1,050,112
│    │    └─ConvBNReluLayer: 3-54                  2,360,832
│    │    └─ConvBNReluLayer: 3-55                  1,054,720
├─PSPModule: 1-7                                   --
│    └─ModuleList: 2-19                            --
│    │    └─Sequential: 3-56                       1,050,112
│    │    └─Sequential: 3-57                       1,050,112
│    │    └─Sequential: 3-58                       1,050,112
│    │    └─Sequential: 3-59                       1,050,112
│    └─CausalityMapBlock: 2-20                     --
│    └─CausalityFactorsExtractor: 2-21             --
│    │    └─StraightThroughEstimator: 3-60         --
│    │    └─ReLU: 3-61                             --
│    │    └─Sigmoid: 3-62                          --
├─Sequential: 1-8                                  --
│    └─Conv2d: 2-22                                18,874,880
│    └─BatchNorm2d: 2-23                           1,024
│    └─ReLU: 2-24                                  --
│    └─Dropout: 2-25                               --
│    └─Conv2d: 2-26                                1,539
├─Sequential: 1-9                                  --
│    └─Conv2d: 2-27                                4,719,104
│    └─BatchNorm2d: 2-28                           1,024
│    └─ReLU: 2-29                                  --
│    └─Dropout: 2-30                               --
│    └─Conv2d: 2-31                                1,539
===========================================================================
Total params: 51,334,150
Trainable params: 51,334,150
Non-trainable params: 0
===========================================================================


# deeplabv3 res50:
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
DeepLabV3                                          --
├─IntermediateLayerGetter: 1-1                     --
│    └─Conv2d: 2-1                                 9,408
│    └─BatchNorm2d: 2-2                            128
│    └─ReLU: 2-3                                   --
│    └─MaxPool2d: 2-4                              --
│    └─Sequential: 2-5                             --
│    │    └─Bottleneck: 3-1                        75,008
│    │    └─Bottleneck: 3-2                        70,400
│    │    └─Bottleneck: 3-3                        70,400
│    └─Sequential: 2-6                             --
│    │    └─Bottleneck: 3-4                        379,392
│    │    └─Bottleneck: 3-5                        280,064
│    │    └─Bottleneck: 3-6                        280,064
│    │    └─Bottleneck: 3-7                        280,064
│    └─Sequential: 2-7                             --
│    │    └─Bottleneck: 3-8                        1,512,448
│    │    └─Bottleneck: 3-9                        1,117,184
│    │    └─Bottleneck: 3-10                       1,117,184
│    │    └─Bottleneck: 3-11                       1,117,184
│    │    └─Bottleneck: 3-12                       1,117,184
│    │    └─Bottleneck: 3-13                       1,117,184
│    └─Sequential: 2-8                             --
│    │    └─Bottleneck: 3-14                       6,039,552
│    │    └─Bottleneck: 3-15                       4,462,592
│    │    └─Bottleneck: 3-16                       4,462,592
├─DeepLabHead: 1-2                                 --
│    └─ASPP: 2-9                                   --
│    │    └─ModuleList: 3-17                       15,206,912
│    │    └─Sequential: 3-18                       328,192
│    └─Conv2d: 2-10                                589,824
│    └─BatchNorm2d: 2-11                           512
│    └─ReLU: 2-12                                  --
│    └─Conv2d: 2-13                                1,028
├─FCNHead: 1-3                                     --
│    └─Conv2d: 2-14                                2,359,296
│    └─BatchNorm2d: 2-15                           512
│    └─ReLU: 2-16                                  --
│    └─Dropout: 2-17                               --
│    └─Conv2d: 2-18                                1,028
===========================================================================
Total params: 41,995,336
Trainable params: 41,995,336
Non-trainable params: 0
===========================================================================

# Segnet 
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
SegNet                                   [1, 4, 256, 256]          --
├─Encoder: 1-1                           [1, 512, 8, 8]            --
│    └─Sequential: 2-1                   [1, 64, 256, 256]         --
│    │    └─Conv2d: 3-1                  [1, 64, 256, 256]         1,792
│    │    └─BatchNorm2d: 3-2             [1, 64, 256, 256]         128
│    │    └─ReLU: 3-3                    [1, 64, 256, 256]         --
│    │    └─Conv2d: 3-4                  [1, 64, 256, 256]         36,928
│    │    └─BatchNorm2d: 3-5             [1, 64, 256, 256]         128
│    │    └─ReLU: 3-6                    [1, 64, 256, 256]         --
│    └─Dropout: 2-2                      [1, 64, 128, 128]         --
│    └─Sequential: 2-3                   [1, 128, 128, 128]        --
│    │    └─Conv2d: 3-7                  [1, 128, 128, 128]        73,856
│    │    └─BatchNorm2d: 3-8             [1, 128, 128, 128]        256
│    │    └─ReLU: 3-9                    [1, 128, 128, 128]        --
│    │    └─Conv2d: 3-10                 [1, 128, 128, 128]        147,584
│    │    └─BatchNorm2d: 3-11            [1, 128, 128, 128]        256
│    │    └─ReLU: 3-12                   [1, 128, 128, 128]        --
│    └─Dropout: 2-4                      [1, 128, 64, 64]          --
│    └─Sequential: 2-5                   [1, 256, 64, 64]          --
│    │    └─Conv2d: 3-13                 [1, 256, 64, 64]          295,168
│    │    └─BatchNorm2d: 3-14            [1, 256, 64, 64]          512
│    │    └─ReLU: 3-15                   [1, 256, 64, 64]          --
│    │    └─Conv2d: 3-16                 [1, 256, 64, 64]          590,080
│    │    └─BatchNorm2d: 3-17            [1, 256, 64, 64]          512
│    │    └─ReLU: 3-18                   [1, 256, 64, 64]          --
│    │    └─Conv2d: 3-19                 [1, 256, 64, 64]          590,080
│    │    └─BatchNorm2d: 3-20            [1, 256, 64, 64]          512
│    │    └─ReLU: 3-21                   [1, 256, 64, 64]          --
│    └─Dropout: 2-6                      [1, 256, 32, 32]          --
│    └─Sequential: 2-7                   [1, 512, 32, 32]          --
│    │    └─Conv2d: 3-22                 [1, 512, 32, 32]          1,180,160
│    │    └─BatchNorm2d: 3-23            [1, 512, 32, 32]          1,024
│    │    └─ReLU: 3-24                   [1, 512, 32, 32]          --
│    │    └─Conv2d: 3-25                 [1, 512, 32, 32]          2,359,808
│    │    └─BatchNorm2d: 3-26            [1, 512, 32, 32]          1,024
│    │    └─ReLU: 3-27                   [1, 512, 32, 32]          --
│    │    └─Conv2d: 3-28                 [1, 512, 32, 32]          2,359,808
│    │    └─BatchNorm2d: 3-29            [1, 512, 32, 32]          1,024
│    │    └─ReLU: 3-30                   [1, 512, 32, 32]          --
│    └─Dropout: 2-8                      [1, 512, 16, 16]          --
│    └─Sequential: 2-9                   [1, 512, 16, 16]          --
│    │    └─Conv2d: 3-31                 [1, 512, 16, 16]          2,359,808
│    │    └─BatchNorm2d: 3-32            [1, 512, 16, 16]          1,024
│    │    └─ReLU: 3-33                   [1, 512, 16, 16]          --
│    │    └─Conv2d: 3-34                 [1, 512, 16, 16]          2,359,808
│    │    └─BatchNorm2d: 3-35            [1, 512, 16, 16]          1,024
│    │    └─ReLU: 3-36                   [1, 512, 16, 16]          --
│    │    └─Conv2d: 3-37                 [1, 512, 16, 16]          2,359,808
│    │    └─BatchNorm2d: 3-38            [1, 512, 16, 16]          1,024
│    │    └─ReLU: 3-39                   [1, 512, 16, 16]          --
│    └─Dropout: 2-10                     [1, 512, 8, 8]            --
├─Sequential: 1-2                        [1, 512, 16, 16]          --
│    └─Conv2d: 2-11                      [1, 512, 16, 16]          2,359,808
│    └─BatchNorm2d: 2-12                 [1, 512, 16, 16]          1,024
│    └─ReLU: 2-13                        [1, 512, 16, 16]          --
│    └─Conv2d: 2-14                      [1, 512, 16, 16]          2,359,808
│    └─BatchNorm2d: 2-15                 [1, 512, 16, 16]          1,024
│    └─ReLU: 2-16                        [1, 512, 16, 16]          --
│    └─Conv2d: 2-17                      [1, 512, 16, 16]          2,359,808
│    └─BatchNorm2d: 2-18                 [1, 512, 16, 16]          1,024
│    └─ReLU: 2-19                        [1, 512, 16, 16]          --
├─Dropout: 1-3                           [1, 512, 16, 16]          --
├─Sequential: 1-4                        [1, 256, 32, 32]          --
│    └─Conv2d: 2-20                      [1, 512, 32, 32]          2,359,808
│    └─BatchNorm2d: 2-21                 [1, 512, 32, 32]          1,024
│    └─ReLU: 2-22                        [1, 512, 32, 32]          --
│    └─Conv2d: 2-23                      [1, 512, 32, 32]          2,359,808
│    └─BatchNorm2d: 2-24                 [1, 512, 32, 32]          1,024
│    └─ReLU: 2-25                        [1, 512, 32, 32]          --
│    └─Conv2d: 2-26                      [1, 256, 32, 32]          1,179,904
│    └─BatchNorm2d: 2-27                 [1, 256, 32, 32]          512
│    └─ReLU: 2-28                        [1, 256, 32, 32]          --
├─Dropout: 1-5                           [1, 256, 32, 32]          --
├─Sequential: 1-6                        [1, 128, 64, 64]          --
│    └─Conv2d: 2-29                      [1, 256, 64, 64]          590,080
│    └─BatchNorm2d: 2-30                 [1, 256, 64, 64]          512
│    └─ReLU: 2-31                        [1, 256, 64, 64]          --
│    └─Conv2d: 2-32                      [1, 256, 64, 64]          590,080
│    └─BatchNorm2d: 2-33                 [1, 256, 64, 64]          512
│    └─ReLU: 2-34                        [1, 256, 64, 64]          --
│    └─Conv2d: 2-35                      [1, 128, 64, 64]          295,040
│    └─BatchNorm2d: 2-36                 [1, 128, 64, 64]          256
│    └─ReLU: 2-37                        [1, 128, 64, 64]          --
├─Dropout: 1-7                           [1, 128, 64, 64]          --
├─Sequential: 1-8                        [1, 64, 128, 128]         --
│    └─Conv2d: 2-38                      [1, 128, 128, 128]        147,584
│    └─BatchNorm2d: 2-39                 [1, 128, 128, 128]        256
│    └─ReLU: 2-40                        [1, 128, 128, 128]        --
│    └─Conv2d: 2-41                      [1, 64, 128, 128]         73,792
│    └─BatchNorm2d: 2-42                 [1, 64, 128, 128]         128
│    └─ReLU: 2-43                        [1, 64, 128, 128]         --
├─Dropout: 1-9                           [1, 64, 128, 128]         --
├─Sequential: 1-10                       [1, 4, 256, 256]          --
│    └─Conv2d: 2-44                      [1, 64, 256, 256]         36,928
│    └─BatchNorm2d: 2-45                 [1, 64, 256, 256]         128
│    └─ReLU: 2-46                        [1, 64, 256, 256]         --
│    └─Conv2d: 2-47                      [1, 4, 256, 256]          2,308
==========================================================================================
Total params: 29,445,316
Trainable params: 29,445,316
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 40.16
==========================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 471.86
Params size (MB): 117.78
Estimated Total Size (MB): 590.43
==========================================================================================

# msaf_unet 不带DW
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
MSAF_UNet                                --
├─DoubleConv: 1-1                        --
│    └─Conv2d: 2-1                       896
│    └─ReLU: 2-2                         --
│    └─BatchNorm2d: 2-3                  64
│    └─Sequential: 2-4                   960
│    │    └─Conv2d: 3-1                  (recursive)
│    │    └─BatchNorm2d: 3-2             (recursive)
│    │    └─ReLU: 3-3                    --
│    └─Conv2d: 2-5                       9,248
│    └─BatchNorm2d: 2-6                  64
│    └─Sequential: 2-7                   9,312
│    │    └─Conv2d: 3-4                  (recursive)
│    │    └─BatchNorm2d: 3-5             (recursive)
│    │    └─ReLU: 3-6                    --
├─ACPN: 1-2                              --
│    └─MaxPool2d: 2-8                    --
│    └─Sequential: 2-9                   --
│    │    └─Conv2d: 3-7                  9,248
│    │    └─BatchNorm2d: 3-8             64
│    │    └─ReLU: 3-9                    --
│    │    └─MaxPool2d: 3-10              --
│    └─Sequential: 2-10                  --
│    │    └─Conv2d: 3-11                 4,624
│    │    └─BatchNorm2d: 3-12            32
│    │    └─ReLU: 3-13                   --
│    │    └─Conv2d: 3-14                 4,640
│    │    └─BatchNorm2d: 3-15            64
│    │    └─ReLU: 3-16                   --
│    │    └─MaxPool2d: 3-17              --
│    └─Sequential: 2-11                  --
│    │    └─Conv2d: 3-18                 4,624
│    │    └─BatchNorm2d: 3-19            32
│    │    └─ReLU: 3-20                   --
│    │    └─Conv2d: 3-21                 2,320
│    │    └─BatchNorm2d: 3-22            32
│    │    └─ReLU: 3-23                   --
│    │    └─Conv2d: 3-24                 4,640
│    │    └─BatchNorm2d: 3-25            64
│    │    └─ReLU: 3-26                   --
│    │    └─MaxPool2d: 3-27              --
│    └─Sequential: 2-12                  --
│    │    └─Conv2d: 3-28                 528
│    │    └─BatchNorm2d: 3-29            32
│    │    └─ReLU: 3-30                   --
│    │    └─Conv2d: 3-31                 544
│    │    └─BatchNorm2d: 3-32            64
│    │    └─ReLU: 3-33                   --
│    │    └─MaxPool2d: 3-34              --
│    └─AdaptiveAvgPool2d: 2-13           --
│    └─Sigmoid: 2-14                     --
│    └─Sequential: 2-15                  --
│    │    └─Conv2d: 3-35                 1,056
│    │    └─BatchNorm2d: 3-36            64
│    │    └─ReLU: 3-37                   --
├─EMAF: 1-3                              --
│    └─Softmax: 2-16                     --
│    └─AdaptiveAvgPool2d: 2-17           --
│    └─AdaptiveAvgPool2d: 2-18           --
│    └─AdaptiveAvgPool2d: 2-19           --
│    └─GroupNorm: 2-20                   2
│    └─Conv2d: 2-21                      2
│    └─Conv2d: 2-22                      10
│    └─AdaptiveAvgPool2d: 2-23           --
│    └─Sequential: 2-24                  --
│    │    └─Conv2d: 3-38                 1
│    │    └─ReLU: 3-39                   --
│    │    └─Conv2d: 3-40                 1
│    │    └─Sigmoid: 3-41                --
├─ResD_Down: 1-4                         --
│    └─MaxPool2d: 2-25                   --
│    └─Dalit_Conv: 2-26                  --
│    │    └─Sequential: 3-42             18,624
│    │    └─Sequential: 3-43             37,056
│    │    └─Sequential: 3-44             37,056
│    └─Conv2d: 2-27                      2,112
│    └─ReLU: 2-28                        --
├─ACPN: 1-5                              --
│    └─MaxPool2d: 2-29                   --
│    └─Sequential: 2-30                  --
│    │    └─Conv2d: 3-45                 36,928
│    │    └─BatchNorm2d: 3-46            128
│    │    └─ReLU: 3-47                   --
│    │    └─MaxPool2d: 3-48              --
│    └─Sequential: 2-31                  --
│    │    └─Conv2d: 3-49                 18,464
│    │    └─BatchNorm2d: 3-50            64
│    │    └─ReLU: 3-51                   --
│    │    └─Conv2d: 3-52                 18,496
│    │    └─BatchNorm2d: 3-53            128
│    │    └─ReLU: 3-54                   --
│    │    └─MaxPool2d: 3-55              --
│    └─Sequential: 2-32                  --
│    │    └─Conv2d: 3-56                 18,464
│    │    └─BatchNorm2d: 3-57            64
│    │    └─ReLU: 3-58                   --
│    │    └─Conv2d: 3-59                 9,248
│    │    └─BatchNorm2d: 3-60            64
│    │    └─ReLU: 3-61                   --
│    │    └─Conv2d: 3-62                 18,496
│    │    └─BatchNorm2d: 3-63            128
│    │    └─ReLU: 3-64                   --
│    │    └─MaxPool2d: 3-65              --
│    └─Sequential: 2-33                  --
│    │    └─Conv2d: 3-66                 2,080
│    │    └─BatchNorm2d: 3-67            64
│    │    └─ReLU: 3-68                   --
│    │    └─Conv2d: 3-69                 2,112
│    │    └─BatchNorm2d: 3-70            128
│    │    └─ReLU: 3-71                   --
│    │    └─MaxPool2d: 3-72              --
│    └─AdaptiveAvgPool2d: 2-34           --
│    └─Sigmoid: 2-35                     --
│    └─Sequential: 2-36                  --
│    │    └─Conv2d: 3-73                 4,160
│    │    └─BatchNorm2d: 3-74            128
│    │    └─ReLU: 3-75                   --
├─EMAF: 1-6                              --
│    └─Softmax: 2-37                     --
│    └─AdaptiveAvgPool2d: 2-38           --
│    └─AdaptiveAvgPool2d: 2-39           --
│    └─AdaptiveAvgPool2d: 2-40           --
│    └─GroupNorm: 2-41                   4
│    └─Conv2d: 2-42                      6
│    └─Conv2d: 2-43                      38
│    └─AdaptiveAvgPool2d: 2-44           --
│    └─Sequential: 2-45                  --
│    │    └─Conv2d: 3-76                 4
│    │    └─ReLU: 3-77                   --
│    │    └─Conv2d: 3-78                 4
│    │    └─Sigmoid: 3-79                --
├─ResD_Down: 1-7                         --
│    └─MaxPool2d: 2-46                   --
│    └─Dalit_Conv: 2-47                  --
│    │    └─Sequential: 3-80             74,112
│    │    └─Sequential: 3-81             147,840
│    │    └─Sequential: 3-82             147,840
│    └─Conv2d: 2-48                      8,320
│    └─ReLU: 2-49                        --
├─ACPN: 1-8                              --
│    └─MaxPool2d: 2-50                   --
│    └─Sequential: 2-51                  --
│    │    └─Conv2d: 3-83                 147,584
│    │    └─BatchNorm2d: 3-84            256
│    │    └─ReLU: 3-85                   --
│    │    └─MaxPool2d: 3-86              --
│    └─Sequential: 2-52                  --
│    │    └─Conv2d: 3-87                 73,792
│    │    └─BatchNorm2d: 3-88            128
│    │    └─ReLU: 3-89                   --
│    │    └─Conv2d: 3-90                 73,856
│    │    └─BatchNorm2d: 3-91            256
│    │    └─ReLU: 3-92                   --
│    │    └─MaxPool2d: 3-93              --
│    └─Sequential: 2-53                  --
│    │    └─Conv2d: 3-94                 73,792
│    │    └─BatchNorm2d: 3-95            128
│    │    └─ReLU: 3-96                   --
│    │    └─Conv2d: 3-97                 36,928
│    │    └─BatchNorm2d: 3-98            128
│    │    └─ReLU: 3-99                   --
│    │    └─Conv2d: 3-100                73,856
│    │    └─BatchNorm2d: 3-101           256
│    │    └─ReLU: 3-102                  --
│    │    └─MaxPool2d: 3-103             --
│    └─Sequential: 2-54                  --
│    │    └─Conv2d: 3-104                8,256
│    │    └─BatchNorm2d: 3-105           128
│    │    └─ReLU: 3-106                  --
│    │    └─Conv2d: 3-107                8,320
│    │    └─BatchNorm2d: 3-108           256
│    │    └─ReLU: 3-109                  --
│    │    └─MaxPool2d: 3-110             --
│    └─AdaptiveAvgPool2d: 2-55           --
│    └─Sigmoid: 2-56                     --
│    └─Sequential: 2-57                  --
│    │    └─Conv2d: 3-111                16,512
│    │    └─BatchNorm2d: 3-112           256
│    │    └─ReLU: 3-113                  --
├─EMAF: 1-9                              --
│    └─Softmax: 2-58                     --
│    └─AdaptiveAvgPool2d: 2-59           --
│    └─AdaptiveAvgPool2d: 2-60           --
│    └─AdaptiveAvgPool2d: 2-61           --
│    └─GroupNorm: 2-62                   8
│    └─Conv2d: 2-63                      20
│    └─Conv2d: 2-64                      148
│    └─AdaptiveAvgPool2d: 2-65           --
│    └─Sequential: 2-66                  --
│    │    └─Conv2d: 3-114                16
│    │    └─ReLU: 3-115                  --
│    │    └─Conv2d: 3-116                16
│    │    └─Sigmoid: 3-117               --
├─ResD_Down: 1-10                        --
│    └─MaxPool2d: 2-67                   --
│    └─Dalit_Conv: 2-68                  --
│    │    └─Sequential: 3-118            295,680
│    │    └─Sequential: 3-119            590,592
│    │    └─Sequential: 3-120            590,592
│    └─Conv2d: 2-69                      33,024
│    └─ReLU: 2-70                        --
├─ACPN: 1-11                             --
│    └─MaxPool2d: 2-71                   --
│    └─Sequential: 2-72                  --
│    │    └─Conv2d: 3-121                590,080
│    │    └─BatchNorm2d: 3-122           512
│    │    └─ReLU: 3-123                  --
│    │    └─MaxPool2d: 3-124             --
│    └─Sequential: 2-73                  --
│    │    └─Conv2d: 3-125                295,040
│    │    └─BatchNorm2d: 3-126           256
│    │    └─ReLU: 3-127                  --
│    │    └─Conv2d: 3-128                295,168
│    │    └─BatchNorm2d: 3-129           512
│    │    └─ReLU: 3-130                  --
│    │    └─MaxPool2d: 3-131             --
│    └─Sequential: 2-74                  --
│    │    └─Conv2d: 3-132                295,040
│    │    └─BatchNorm2d: 3-133           256
│    │    └─ReLU: 3-134                  --
│    │    └─Conv2d: 3-135                147,584
│    │    └─BatchNorm2d: 3-136           256
│    │    └─ReLU: 3-137                  --
│    │    └─Conv2d: 3-138                295,168
│    │    └─BatchNorm2d: 3-139           512
│    │    └─ReLU: 3-140                  --
│    │    └─MaxPool2d: 3-141             --
│    └─Sequential: 2-75                  --
│    │    └─Conv2d: 3-142                32,896
│    │    └─BatchNorm2d: 3-143           256
│    │    └─ReLU: 3-144                  --
│    │    └─Conv2d: 3-145                33,024
│    │    └─BatchNorm2d: 3-146           512
│    │    └─ReLU: 3-147                  --
│    │    └─MaxPool2d: 3-148             --
│    └─AdaptiveAvgPool2d: 2-76           --
│    └─Sigmoid: 2-77                     --
│    └─Sequential: 2-78                  --
│    │    └─Conv2d: 3-149                65,792
│    │    └─BatchNorm2d: 3-150           512
│    │    └─ReLU: 3-151                  --
├─EMAF: 1-12                             --
│    └─Softmax: 2-79                     --
│    └─AdaptiveAvgPool2d: 2-80           --
│    └─AdaptiveAvgPool2d: 2-81           --
│    └─AdaptiveAvgPool2d: 2-82           --
│    └─GroupNorm: 2-83                   16
│    └─Conv2d: 2-84                      72
│    └─Conv2d: 2-85                      584
│    └─AdaptiveAvgPool2d: 2-86           --
│    └─Sequential: 2-87                  --
│    │    └─Conv2d: 3-152                64
│    │    └─ReLU: 3-153                  --
│    │    └─Conv2d: 3-154                64
│    │    └─Sigmoid: 3-155               --
├─Dropout2d: 1-13                        --
├─Dropout2d: 1-14                        --
├─Dropout2d: 1-15                        --
├─MaxPool2d: 1-16                        --
├─DoubleConv: 1-17                       --
│    └─Conv2d: 2-88                      1,180,160
│    └─ReLU: 2-89                        --
│    └─BatchNorm2d: 2-90                 1,024
│    └─Sequential: 2-91                  1,181,184
│    │    └─Conv2d: 3-156                (recursive)
│    │    └─BatchNorm2d: 3-157           (recursive)
│    │    └─ReLU: 3-158                  --
│    └─Conv2d: 2-92                      1,179,904
│    └─BatchNorm2d: 2-93                 512
│    └─Sequential: 2-94                  1,180,416
│    │    └─Conv2d: 3-159                (recursive)
│    │    └─BatchNorm2d: 3-160           (recursive)
│    │    └─ReLU: 3-161                  --
├─ResD_Up: 1-18                          --
│    └─ReLU: 2-95                        --
│    └─Upsample: 2-96                    --
│    └─Dalit_Conv: 2-97                  --
│    │    └─Sequential: 3-162            590,208
│    │    └─Sequential: 3-163            147,840
│    │    └─Sequential: 3-164            147,840
│    └─Conv2d: 2-98                      65,664
├─ACPN: 1-19                             --
│    └─MaxPool2d: 2-99                   --
│    └─Sequential: 2-100                 --
│    │    └─Conv2d: 3-165                147,584
│    │    └─BatchNorm2d: 3-166           256
│    │    └─ReLU: 3-167                  --
│    │    └─MaxPool2d: 3-168             --
│    └─Sequential: 2-101                 --
│    │    └─Conv2d: 3-169                73,792
│    │    └─BatchNorm2d: 3-170           128
│    │    └─ReLU: 3-171                  --
│    │    └─Conv2d: 3-172                73,856
│    │    └─BatchNorm2d: 3-173           256
│    │    └─ReLU: 3-174                  --
│    │    └─MaxPool2d: 3-175             --
│    └─Sequential: 2-102                 --
│    │    └─Conv2d: 3-176                73,792
│    │    └─BatchNorm2d: 3-177           128
│    │    └─ReLU: 3-178                  --
│    │    └─Conv2d: 3-179                36,928
│    │    └─BatchNorm2d: 3-180           128
│    │    └─ReLU: 3-181                  --
│    │    └─Conv2d: 3-182                73,856
│    │    └─BatchNorm2d: 3-183           256
│    │    └─ReLU: 3-184                  --
│    │    └─MaxPool2d: 3-185             --
│    └─Sequential: 2-103                 --
│    │    └─Conv2d: 3-186                8,256
│    │    └─BatchNorm2d: 3-187           128
│    │    └─ReLU: 3-188                  --
│    │    └─Conv2d: 3-189                8,320
│    │    └─BatchNorm2d: 3-190           256
│    │    └─ReLU: 3-191                  --
│    │    └─MaxPool2d: 3-192             --
│    └─AdaptiveAvgPool2d: 2-104          --
│    └─Sigmoid: 2-105                    --
│    └─Sequential: 2-106                 --
│    │    └─Conv2d: 3-193                16,512
│    │    └─BatchNorm2d: 3-194           256
│    │    └─ReLU: 3-195                  --
├─ResD_Up: 1-20                          --
│    └─ReLU: 2-107                       --
│    └─Upsample: 2-108                   --
│    └─Dalit_Conv: 2-109                 --
│    │    └─Sequential: 3-196            147,648
│    │    └─Sequential: 3-197            37,056
│    │    └─Sequential: 3-198            37,056
│    └─Conv2d: 2-110                     16,448
├─ACPN: 1-21                             --
│    └─MaxPool2d: 2-111                  --
│    └─Sequential: 2-112                 --
│    │    └─Conv2d: 3-199                36,928
│    │    └─BatchNorm2d: 3-200           128
│    │    └─ReLU: 3-201                  --
│    │    └─MaxPool2d: 3-202             --
│    └─Sequential: 2-113                 --
│    │    └─Conv2d: 3-203                18,464
│    │    └─BatchNorm2d: 3-204           64
│    │    └─ReLU: 3-205                  --
│    │    └─Conv2d: 3-206                18,496
│    │    └─BatchNorm2d: 3-207           128
│    │    └─ReLU: 3-208                  --
│    │    └─MaxPool2d: 3-209             --
│    └─Sequential: 2-114                 --
│    │    └─Conv2d: 3-210                18,464
│    │    └─BatchNorm2d: 3-211           64
│    │    └─ReLU: 3-212                  --
│    │    └─Conv2d: 3-213                9,248
│    │    └─BatchNorm2d: 3-214           64
│    │    └─ReLU: 3-215                  --
│    │    └─Conv2d: 3-216                18,496
│    │    └─BatchNorm2d: 3-217           128
│    │    └─ReLU: 3-218                  --
│    │    └─MaxPool2d: 3-219             --
│    └─Sequential: 2-115                 --
│    │    └─Conv2d: 3-220                2,080
│    │    └─BatchNorm2d: 3-221           64
│    │    └─ReLU: 3-222                  --
│    │    └─Conv2d: 3-223                2,112
│    │    └─BatchNorm2d: 3-224           128
│    │    └─ReLU: 3-225                  --
│    │    └─MaxPool2d: 3-226             --
│    └─AdaptiveAvgPool2d: 2-116          --
│    └─Sigmoid: 2-117                    --
│    └─Sequential: 2-118                 --
│    │    └─Conv2d: 3-227                4,160
│    │    └─BatchNorm2d: 3-228           128
│    │    └─ReLU: 3-229                  --
├─ResD_Up: 1-22                          --
│    └─ReLU: 2-119                       --
│    └─Upsample: 2-120                   --
│    └─Dalit_Conv: 2-121                 --
│    │    └─Sequential: 3-230            36,960
│    │    └─Sequential: 3-231            9,312
│    │    └─Sequential: 3-232            9,312
│    └─Conv2d: 2-122                     4,128
├─ACPN: 1-23                             --
│    └─MaxPool2d: 2-123                  --
│    └─Sequential: 2-124                 --
│    │    └─Conv2d: 3-233                9,248
│    │    └─BatchNorm2d: 3-234           64
│    │    └─ReLU: 3-235                  --
│    │    └─MaxPool2d: 3-236             --
│    └─Sequential: 2-125                 --
│    │    └─Conv2d: 3-237                4,624
│    │    └─BatchNorm2d: 3-238           32
│    │    └─ReLU: 3-239                  --
│    │    └─Conv2d: 3-240                4,640
│    │    └─BatchNorm2d: 3-241           64
│    │    └─ReLU: 3-242                  --
│    │    └─MaxPool2d: 3-243             --
│    └─Sequential: 2-126                 --
│    │    └─Conv2d: 3-244                4,624
│    │    └─BatchNorm2d: 3-245           32
│    │    └─ReLU: 3-246                  --
│    │    └─Conv2d: 3-247                2,320
│    │    └─BatchNorm2d: 3-248           32
│    │    └─ReLU: 3-249                  --
│    │    └─Conv2d: 3-250                4,640
│    │    └─BatchNorm2d: 3-251           64
│    │    └─ReLU: 3-252                  --
│    │    └─MaxPool2d: 3-253             --
│    └─Sequential: 2-127                 --
│    │    └─Conv2d: 3-254                528
│    │    └─BatchNorm2d: 3-255           32
│    │    └─ReLU: 3-256                  --
│    │    └─Conv2d: 3-257                544
│    │    └─BatchNorm2d: 3-258           64
│    │    └─ReLU: 3-259                  --
│    │    └─MaxPool2d: 3-260             --
│    └─AdaptiveAvgPool2d: 2-128          --
│    └─Sigmoid: 2-129                    --
│    └─Sequential: 2-130                 --
│    │    └─Conv2d: 3-261                1,056
│    │    └─BatchNorm2d: 3-262           64
│    │    └─ReLU: 3-263                  --
├─Up: 1-24                               --
│    └─Upsample: 2-131                   --
│    └─DoubleConv: 2-132                 --
│    │    └─Conv2d: 3-264                9,232
│    │    └─ReLU: 3-265                  --
│    │    └─BatchNorm2d: 3-266           32
│    │    └─Sequential: 3-267            9,264
│    │    └─Conv2d: 3-268                4,640
│    │    └─BatchNorm2d: 3-269           64
│    │    └─Sequential: 3-270            4,704
├─ACPN: 1-25                             --
│    └─MaxPool2d: 2-133                  --
│    └─Sequential: 2-134                 --
│    │    └─Conv2d: 3-271                9,248
│    │    └─BatchNorm2d: 3-272           64
│    │    └─ReLU: 3-273                  --
│    │    └─MaxPool2d: 3-274             --
│    └─Sequential: 2-135                 --
│    │    └─Conv2d: 3-275                4,624
│    │    └─BatchNorm2d: 3-276           32
│    │    └─ReLU: 3-277                  --
│    │    └─Conv2d: 3-278                4,640
│    │    └─BatchNorm2d: 3-279           64
│    │    └─ReLU: 3-280                  --
│    │    └─MaxPool2d: 3-281             --
│    └─Sequential: 2-136                 --
│    │    └─Conv2d: 3-282                4,624
│    │    └─BatchNorm2d: 3-283           32
│    │    └─ReLU: 3-284                  --
│    │    └─Conv2d: 3-285                2,320
│    │    └─BatchNorm2d: 3-286           32
│    │    └─ReLU: 3-287                  --
│    │    └─Conv2d: 3-288                4,640
│    │    └─BatchNorm2d: 3-289           64
│    │    └─ReLU: 3-290                  --
│    │    └─MaxPool2d: 3-291             --
│    └─Sequential: 2-137                 --
│    │    └─Conv2d: 3-292                528
│    │    └─BatchNorm2d: 3-293           32
│    │    └─ReLU: 3-294                  --
│    │    └─Conv2d: 3-295                544
│    │    └─BatchNorm2d: 3-296           64
│    │    └─ReLU: 3-297                  --
│    │    └─MaxPool2d: 3-298             --
│    └─AdaptiveAvgPool2d: 2-138          --
│    └─Sigmoid: 2-139                    --
│    └─Sequential: 2-140                 --
│    │    └─Conv2d: 3-299                1,056
│    │    └─BatchNorm2d: 3-300           64
│    │    └─ReLU: 3-301                  --
├─OutConv: 1-26                          --
│    └─Conv2d: 2-141                     132
=================================================================
Total params: 11,444,668
Trainable params: 11,444,668
Non-trainable params: 0
=================================================================

# AICUNet
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
AICUNet                                  --
├─AIConv2d: 1-1                          --
│    └─ReLU: 2-1                         --
│    └─BatchNorm2d: 2-2                  64
│    └─Conv2d: 2-3                       128
│    └─ModuleDict: 2-4                   --
│    │    └─ModuleList: 3-1              1,536
│    │    └─ModuleList: 3-2              1,536
│    └─Sequential: 2-5                   --
│    │    └─Conv2d: 3-3                  24
│    │    └─AdaptiveAvgPool2d: 3-4       --
│    │    └─Flatten: 3-5                 --
├─AIConv2d: 1-2                          --
│    └─ReLU: 2-6                         --
│    └─BatchNorm2d: 2-7                  128
│    └─Conv2d: 2-8                       2,112
│    └─ModuleDict: 2-9                   --
│    │    └─ModuleList: 3-6              30,912
│    │    └─ModuleList: 3-7              30,912
│    └─Sequential: 2-10                  --
│    │    └─Conv2d: 3-8                  198
│    │    └─AdaptiveAvgPool2d: 3-9       --
│    │    └─Flatten: 3-10                --
├─AIConv2d: 1-3                          --
│    └─ReLU: 2-11                        --
│    └─BatchNorm2d: 2-12                 256
│    └─Conv2d: 2-13                      8,320
│    └─ModuleDict: 2-14                  --
│    │    └─ModuleList: 3-11             123,264
│    │    └─ModuleList: 3-12             123,264
│    └─Sequential: 2-15                  --
│    │    └─Conv2d: 3-13                 390
│    │    └─AdaptiveAvgPool2d: 3-14      --
│    │    └─Flatten: 3-15                --
├─AIConv2d: 1-4                          --
│    └─ReLU: 2-16                        --
│    └─BatchNorm2d: 2-17                 512
│    └─Conv2d: 2-18                      33,024
│    └─ModuleDict: 2-19                  --
│    │    └─ModuleList: 3-16             492,288
│    │    └─ModuleList: 3-17             492,288
│    └─Sequential: 2-20                  --
│    │    └─Conv2d: 3-18                 774
│    │    └─AdaptiveAvgPool2d: 3-19      --
│    │    └─Flatten: 3-20                --
├─MaxPool2d: 1-5                         --
├─Dropout2d: 1-6                         --
├─Dropout2d: 1-7                         --
├─Dropout2d: 1-8                         --
├─DoubleConv: 1-9                        --
│    └─Conv2d: 2-21                      1,180,160
│    └─ReLU: 2-22                        --
│    └─BatchNorm2d: 2-23                 1,024
│    └─Sequential: 2-24                  1,181,184
│    │    └─Conv2d: 3-21                 (recursive)
│    │    └─BatchNorm2d: 3-22            (recursive)
│    │    └─ReLU: 3-23                   --
│    └─Conv2d: 2-25                      1,179,904
│    └─BatchNorm2d: 2-26                 512
│    └─Sequential: 2-27                  1,180,416
│    │    └─Conv2d: 3-24                 (recursive)
│    │    └─BatchNorm2d: 3-25            (recursive)
│    │    └─ReLU: 3-26                   --
├─AIConv2d: 1-10                         --
│    └─ReLU: 2-28                        --
│    └─BatchNorm2d: 2-29                 256
│    └─Conv2d: 2-30                      65,664
│    └─ModuleDict: 2-31                  --
│    │    └─ModuleList: 3-27             983,424
│    │    └─ModuleList: 3-28             983,424
│    └─Sequential: 2-32                  --
│    │    └─Conv2d: 3-29                 3,078
│    │    └─AdaptiveAvgPool2d: 3-30      --
│    │    └─Flatten: 3-31                --
├─AIConv2d: 1-11                         --
│    └─ReLU: 2-33                        --
│    └─BatchNorm2d: 2-34                 128
│    └─Conv2d: 2-35                      16,448
│    └─ModuleDict: 2-36                  --
│    │    └─ModuleList: 3-32             245,952
│    │    └─ModuleList: 3-33             245,952
│    └─Sequential: 2-37                  --
│    │    └─Conv2d: 3-34                 1,542
│    │    └─AdaptiveAvgPool2d: 3-35      --
│    │    └─Flatten: 3-36                --
├─AIConv2d: 1-12                         --
│    └─ReLU: 2-38                        --
│    └─BatchNorm2d: 2-39                 64
│    └─Conv2d: 2-40                      4,128
│    └─ModuleDict: 2-41                  --
│    │    └─ModuleList: 3-37             61,536
│    │    └─ModuleList: 3-38             61,536
│    └─Sequential: 2-42                  --
│    │    └─Conv2d: 3-39                 774
│    │    └─AdaptiveAvgPool2d: 3-40      --
│    │    └─Flatten: 3-41                --
├─AIConv2d: 1-13                         --
│    └─ReLU: 2-43                        --
│    └─BatchNorm2d: 2-44                 64
│    └─Conv2d: 2-45                      2,080
│    └─ModuleDict: 2-46                  --
│    │    └─ModuleList: 3-42             30,816
│    │    └─ModuleList: 3-43             30,816
│    └─Sequential: 2-47                  --
│    │    └─Conv2d: 3-44                 390
│    │    └─AdaptiveAvgPool2d: 3-45      --
│    │    └─Flatten: 3-46                --
├─Upsample: 1-14                         --
├─OutConv: 1-15                          --
│    └─Conv2d: 2-48                      132
=================================================================
Total params: 8,803,334
Trainable params: 8,803,334
Non-trainable params: 0
=================================================================

# msaf_unetv2 
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
MSAF_UNetv2                              [1, 4, 256, 256]          --
├─DoubleConv: 1-1                        [1, 32, 256, 256]         --
│    └─Sequential: 2-1                   [1, 32, 256, 256]         --
│    │    └─Conv2d: 3-1                  [1, 32, 256, 256]         896
│    │    └─BatchNorm2d: 3-2             [1, 32, 256, 256]         64
│    └─Sequential: 2-2                   --                        (recursive)
│    │    └─ReLU: 3-3                    [1, 32, 256, 256]         --
│    └─Sequential: 2-3                   [1, 32, 256, 256]         --
│    │    └─Conv2d: 3-4                  [1, 32, 256, 256]         9,248
│    │    └─BatchNorm2d: 3-5             [1, 32, 256, 256]         64
│    │    └─ReLU: 3-6                    [1, 32, 256, 256]         --
├─ACPNv2: 1-2                            [1, 32, 256, 256]         --
│    └─MaxPool2d: 2-4                    [1, 32, 256, 256]         --
│    └─AdaptiveAvgPool2d: 2-5            [1, 32, 1, 1]             --
│    └─Sequential: 2-6                   [1, 32, 256, 256]         --
│    │    └─DWConv: 3-7                  [1, 32, 256, 256]         1,376
│    │    └─BatchNorm2d: 3-8             [1, 32, 256, 256]         64
│    │    └─ReLU: 3-9                    [1, 32, 256, 256]         --
│    └─AdaptiveAvgPool2d: 2-7            [1, 32, 1, 1]             --
│    └─Sequential: 2-8                   [1, 32, 256, 256]         --
│    │    └─DWConv: 3-10                 [1, 16, 256, 256]         848
│    │    └─BatchNorm2d: 3-11            [1, 16, 256, 256]         32
│    │    └─ReLU: 3-12                   [1, 16, 256, 256]         --
│    │    └─DWConv: 3-13                 [1, 32, 256, 256]         704
│    │    └─BatchNorm2d: 3-14            [1, 32, 256, 256]         64
│    │    └─ReLU: 3-15                   [1, 32, 256, 256]         --
│    └─AdaptiveAvgPool2d: 2-9            [1, 32, 1, 1]             --
│    └─Sequential: 2-10                  [1, 32, 256, 256]         --
│    │    └─DWConv: 3-16                 [1, 16, 256, 256]         848
│    │    └─BatchNorm2d: 3-17            [1, 16, 256, 256]         32
│    │    └─ReLU: 3-18                   [1, 16, 256, 256]         --
│    │    └─DWConv: 3-19                 [1, 16, 256, 256]         432
│    │    └─BatchNorm2d: 3-20            [1, 16, 256, 256]         32
│    │    └─ReLU: 3-21                   [1, 16, 256, 256]         --
│    │    └─DWConv: 3-22                 [1, 32, 256, 256]         704
│    │    └─BatchNorm2d: 3-23            [1, 32, 256, 256]         64
│    │    └─ReLU: 3-24                   [1, 32, 256, 256]         --
│    └─AdaptiveAvgPool2d: 2-11           [1, 32, 1, 1]             --
│    └─Sequential: 2-12                  [1, 128, 1, 1]            --
│    │    └─Conv2d: 3-25                 [1, 32, 1, 1]             4,128
│    │    └─ReLU: 3-26                   [1, 32, 1, 1]             --
│    │    └─Conv2d: 3-27                 [1, 128, 1, 1]            4,224
│    └─Sigmoid: 2-13                     [1, 128, 1, 1]            --
│    └─Sequential: 2-14                  [1, 32, 256, 256]         --
│    │    └─Conv2d: 3-28                 [1, 32, 256, 256]         1,056
│    │    └─BatchNorm2d: 3-29            [1, 32, 256, 256]         64
│    │    └─ReLU: 3-30                   [1, 32, 256, 256]         --
├─EMAF: 1-3                              [1, 32, 256, 256]         --
│    └─AdaptiveAvgPool2d: 2-15           [32, 1, 256, 1]           --
│    └─AdaptiveAvgPool2d: 2-16           [32, 1, 1, 256]           --
│    └─Conv2d: 2-17                      [32, 1, 512, 1]           2
│    └─GroupNorm: 2-18                   [32, 1, 256, 256]         2
│    └─AdaptiveAvgPool2d: 2-19           [32, 1, 1, 1]             --
│    └─Softmax: 2-20                     [32, 1, 1, 1]             --
│    └─Conv2d: 2-21                      [32, 1, 256, 256]         10
│    └─AdaptiveAvgPool2d: 2-22           [32, 1, 1, 1]             --
│    └─Sequential: 2-23                  [32, 1, 1, 1]             --
│    │    └─Conv2d: 3-31                 [32, 1, 1, 1]             1
│    │    └─ReLU: 3-32                   [32, 1, 1, 1]             --
│    │    └─Conv2d: 3-33                 [32, 1, 1, 1]             1
│    │    └─Sigmoid: 3-34                [32, 1, 1, 1]             --
├─ResD_Down: 1-4                         [1, 64, 128, 128]         --
│    └─MaxPool2d: 2-24                   [1, 32, 128, 128]         --
│    └─Conv2d: 2-25                      [1, 64, 128, 128]         2,112
│    └─Dalit_Conv: 2-26                  [1, 64, 128, 128]         --
│    │    └─Sequential: 3-35             [1, 64, 128, 128]         18,624
│    │    └─Sequential: 3-36             [1, 64, 128, 128]         37,056
│    │    └─Sequential: 3-37             [1, 64, 128, 128]         37,056
│    └─ReLU: 2-27                        [1, 64, 128, 128]         --
├─ACPNv2: 1-5                            [1, 64, 128, 128]         --
│    └─MaxPool2d: 2-28                   [1, 64, 128, 128]         --
│    └─AdaptiveAvgPool2d: 2-29           [1, 64, 1, 1]             --
│    └─Sequential: 2-30                  [1, 64, 128, 128]         --
│    │    └─DWConv: 3-38                 [1, 64, 128, 128]         4,800
│    │    └─BatchNorm2d: 3-39            [1, 64, 128, 128]         128
│    │    └─ReLU: 3-40                   [1, 64, 128, 128]         --
│    └─AdaptiveAvgPool2d: 2-31           [1, 64, 1, 1]             --
│    └─Sequential: 2-32                  [1, 64, 128, 128]         --
│    │    └─DWConv: 3-41                 [1, 32, 128, 128]         2,720
│    │    └─BatchNorm2d: 3-42            [1, 32, 128, 128]         64
│    │    └─ReLU: 3-43                   [1, 32, 128, 128]         --
│    │    └─DWConv: 3-44                 [1, 64, 128, 128]         2,432
│    │    └─BatchNorm2d: 3-45            [1, 64, 128, 128]         128
│    │    └─ReLU: 3-46                   [1, 64, 128, 128]         --
│    └─AdaptiveAvgPool2d: 2-33           [1, 64, 1, 1]             --
│    └─Sequential: 2-34                  [1, 64, 128, 128]         --
│    │    └─DWConv: 3-47                 [1, 32, 128, 128]         2,720
│    │    └─BatchNorm2d: 3-48            [1, 32, 128, 128]         64
│    │    └─ReLU: 3-49                   [1, 32, 128, 128]         --
│    │    └─DWConv: 3-50                 [1, 32, 128, 128]         1,376
│    │    └─BatchNorm2d: 3-51            [1, 32, 128, 128]         64
│    │    └─ReLU: 3-52                   [1, 32, 128, 128]         --
│    │    └─DWConv: 3-53                 [1, 64, 128, 128]         2,432
│    │    └─BatchNorm2d: 3-54            [1, 64, 128, 128]         128
│    │    └─ReLU: 3-55                   [1, 64, 128, 128]         --
│    └─AdaptiveAvgPool2d: 2-35           [1, 64, 1, 1]             --
│    └─Sequential: 2-36                  [1, 256, 1, 1]            --
│    │    └─Conv2d: 3-56                 [1, 64, 1, 1]             16,448
│    │    └─ReLU: 3-57                   [1, 64, 1, 1]             --
│    │    └─Conv2d: 3-58                 [1, 256, 1, 1]            16,640
│    └─Sigmoid: 2-37                     [1, 256, 1, 1]            --
│    └─Sequential: 2-38                  [1, 64, 128, 128]         --
│    │    └─Conv2d: 3-59                 [1, 64, 128, 128]         4,160
│    │    └─BatchNorm2d: 3-60            [1, 64, 128, 128]         128
│    │    └─ReLU: 3-61                   [1, 64, 128, 128]         --
├─EMAF: 1-6                              [1, 64, 128, 128]         --
│    └─AdaptiveAvgPool2d: 2-39           [32, 2, 128, 1]           --
│    └─AdaptiveAvgPool2d: 2-40           [32, 2, 1, 128]           --
│    └─Conv2d: 2-41                      [32, 2, 256, 1]           6
│    └─GroupNorm: 2-42                   [32, 2, 128, 128]         4
│    └─AdaptiveAvgPool2d: 2-43           [32, 2, 1, 1]             --
│    └─Softmax: 2-44                     [32, 2, 1, 1]             --
│    └─Conv2d: 2-45                      [32, 2, 128, 128]         38
│    └─AdaptiveAvgPool2d: 2-46           [32, 2, 1, 1]             --
│    └─Sequential: 2-47                  [32, 2, 1, 1]             --
│    │    └─Conv2d: 3-62                 [32, 2, 1, 1]             4
│    │    └─ReLU: 3-63                   [32, 2, 1, 1]             --
│    │    └─Conv2d: 3-64                 [32, 2, 1, 1]             4
│    │    └─Sigmoid: 3-65                [32, 2, 1, 1]             --
├─Dropout2d: 1-7                         [1, 64, 128, 128]         --
├─ResD_Down: 1-8                         [1, 128, 64, 64]          --
│    └─MaxPool2d: 2-48                   [1, 64, 64, 64]           --
│    └─Conv2d: 2-49                      [1, 128, 64, 64]          8,320
│    └─Dalit_Conv: 2-50                  [1, 128, 64, 64]          --
│    │    └─Sequential: 3-66             [1, 128, 64, 64]          74,112
│    │    └─Sequential: 3-67             [1, 128, 64, 64]          147,840
│    │    └─Sequential: 3-68             [1, 128, 64, 64]          147,840
│    └─ReLU: 2-51                        [1, 128, 64, 64]          --
├─ACPNv2: 1-9                            [1, 128, 64, 64]          --
│    └─MaxPool2d: 2-52                   [1, 128, 64, 64]          --
│    └─AdaptiveAvgPool2d: 2-53           [1, 128, 1, 1]            --
│    └─Sequential: 2-54                  [1, 128, 64, 64]          --
│    │    └─DWConv: 3-69                 [1, 128, 64, 64]          17,792
│    │    └─BatchNorm2d: 3-70            [1, 128, 64, 64]          256
│    │    └─ReLU: 3-71                   [1, 128, 64, 64]          --
│    └─AdaptiveAvgPool2d: 2-55           [1, 128, 1, 1]            --
│    └─Sequential: 2-56                  [1, 128, 64, 64]          --
│    │    └─DWConv: 3-72                 [1, 64, 64, 64]           9,536
│    │    └─BatchNorm2d: 3-73            [1, 64, 64, 64]           128
│    │    └─ReLU: 3-74                   [1, 64, 64, 64]           --
│    │    └─DWConv: 3-75                 [1, 128, 64, 64]          8,960
│    │    └─BatchNorm2d: 3-76            [1, 128, 64, 64]          256
│    │    └─ReLU: 3-77                   [1, 128, 64, 64]          --
│    └─AdaptiveAvgPool2d: 2-57           [1, 128, 1, 1]            --
│    └─Sequential: 2-58                  [1, 128, 64, 64]          --
│    │    └─DWConv: 3-78                 [1, 64, 64, 64]           9,536
│    │    └─BatchNorm2d: 3-79            [1, 64, 64, 64]           128
│    │    └─ReLU: 3-80                   [1, 64, 64, 64]           --
│    │    └─DWConv: 3-81                 [1, 64, 64, 64]           4,800
│    │    └─BatchNorm2d: 3-82            [1, 64, 64, 64]           128
│    │    └─ReLU: 3-83                   [1, 64, 64, 64]           --
│    │    └─DWConv: 3-84                 [1, 128, 64, 64]          8,960
│    │    └─BatchNorm2d: 3-85            [1, 128, 64, 64]          256
│    │    └─ReLU: 3-86                   [1, 128, 64, 64]          --
│    └─AdaptiveAvgPool2d: 2-59           [1, 128, 1, 1]            --
│    └─Sequential: 2-60                  [1, 512, 1, 1]            --
│    │    └─Conv2d: 3-87                 [1, 128, 1, 1]            65,664
│    │    └─ReLU: 3-88                   [1, 128, 1, 1]            --
│    │    └─Conv2d: 3-89                 [1, 512, 1, 1]            66,048
│    └─Sigmoid: 2-61                     [1, 512, 1, 1]            --
│    └─Sequential: 2-62                  [1, 128, 64, 64]          --
│    │    └─Conv2d: 3-90                 [1, 128, 64, 64]          16,512
│    │    └─BatchNorm2d: 3-91            [1, 128, 64, 64]          256
│    │    └─ReLU: 3-92                   [1, 128, 64, 64]          --
├─EMAF: 1-10                             [1, 128, 64, 64]          --
│    └─AdaptiveAvgPool2d: 2-63           [32, 4, 64, 1]            --
│    └─AdaptiveAvgPool2d: 2-64           [32, 4, 1, 64]            --
│    └─Conv2d: 2-65                      [32, 4, 128, 1]           20
│    └─GroupNorm: 2-66                   [32, 4, 64, 64]           8
│    └─AdaptiveAvgPool2d: 2-67           [32, 4, 1, 1]             --
│    └─Softmax: 2-68                     [32, 4, 1, 1]             --
│    └─Conv2d: 2-69                      [32, 4, 64, 64]           148
│    └─AdaptiveAvgPool2d: 2-70           [32, 4, 1, 1]             --
│    └─Sequential: 2-71                  [32, 4, 1, 1]             --
│    │    └─Conv2d: 3-93                 [32, 4, 1, 1]             16
│    │    └─ReLU: 3-94                   [32, 4, 1, 1]             --
│    │    └─Conv2d: 3-95                 [32, 4, 1, 1]             16
│    │    └─Sigmoid: 3-96                [32, 4, 1, 1]             --
├─Dropout2d: 1-11                        [1, 128, 64, 64]          --
├─ResD_Down: 1-12                        [1, 256, 32, 32]          --
│    └─MaxPool2d: 2-72                   [1, 128, 32, 32]          --
│    └─Conv2d: 2-73                      [1, 256, 32, 32]          33,024
│    └─Dalit_Conv: 2-74                  [1, 256, 32, 32]          --
│    │    └─Sequential: 3-97             [1, 256, 32, 32]          295,680
│    │    └─Sequential: 3-98             [1, 256, 32, 32]          590,592
│    │    └─Sequential: 3-99             [1, 256, 32, 32]          590,592
│    └─ReLU: 2-75                        [1, 256, 32, 32]          --
├─ACPNv2: 1-13                           [1, 256, 32, 32]          --
│    └─MaxPool2d: 2-76                   [1, 256, 32, 32]          --
│    └─AdaptiveAvgPool2d: 2-77           [1, 256, 1, 1]            --
│    └─Sequential: 2-78                  [1, 256, 32, 32]          --
│    │    └─DWConv: 3-100                [1, 256, 32, 32]          68,352
│    │    └─BatchNorm2d: 3-101           [1, 256, 32, 32]          512
│    │    └─ReLU: 3-102                  [1, 256, 32, 32]          --
│    └─AdaptiveAvgPool2d: 2-79           [1, 256, 1, 1]            --
│    └─Sequential: 2-80                  [1, 256, 32, 32]          --
│    │    └─DWConv: 3-103                [1, 128, 32, 32]          35,456
│    │    └─BatchNorm2d: 3-104           [1, 128, 32, 32]          256
│    │    └─ReLU: 3-105                  [1, 128, 32, 32]          --
│    │    └─DWConv: 3-106                [1, 256, 32, 32]          34,304
│    │    └─BatchNorm2d: 3-107           [1, 256, 32, 32]          512
│    │    └─ReLU: 3-108                  [1, 256, 32, 32]          --
│    └─AdaptiveAvgPool2d: 2-81           [1, 256, 1, 1]            --
│    └─Sequential: 2-82                  [1, 256, 32, 32]          --
│    │    └─DWConv: 3-109                [1, 128, 32, 32]          35,456
│    │    └─BatchNorm2d: 3-110           [1, 128, 32, 32]          256
│    │    └─ReLU: 3-111                  [1, 128, 32, 32]          --
│    │    └─DWConv: 3-112                [1, 128, 32, 32]          17,792
│    │    └─BatchNorm2d: 3-113           [1, 128, 32, 32]          256
│    │    └─ReLU: 3-114                  [1, 128, 32, 32]          --
│    │    └─DWConv: 3-115                [1, 256, 32, 32]          34,304
│    │    └─BatchNorm2d: 3-116           [1, 256, 32, 32]          512
│    │    └─ReLU: 3-117                  [1, 256, 32, 32]          --
│    └─AdaptiveAvgPool2d: 2-83           [1, 256, 1, 1]            --
│    └─Sequential: 2-84                  [1, 1024, 1, 1]           --
│    │    └─Conv2d: 3-118                [1, 256, 1, 1]            262,400
│    │    └─ReLU: 3-119                  [1, 256, 1, 1]            --
│    │    └─Conv2d: 3-120                [1, 1024, 1, 1]           263,168
│    └─Sigmoid: 2-85                     [1, 1024, 1, 1]           --
│    └─Sequential: 2-86                  [1, 256, 32, 32]          --
│    │    └─Conv2d: 3-121                [1, 256, 32, 32]          65,792
│    │    └─BatchNorm2d: 3-122           [1, 256, 32, 32]          512
│    │    └─ReLU: 3-123                  [1, 256, 32, 32]          --
├─EMAF: 1-14                             [1, 256, 32, 32]          --
│    └─AdaptiveAvgPool2d: 2-87           [32, 8, 32, 1]            --
│    └─AdaptiveAvgPool2d: 2-88           [32, 8, 1, 32]            --
│    └─Conv2d: 2-89                      [32, 8, 64, 1]            72
│    └─GroupNorm: 2-90                   [32, 8, 32, 32]           16
│    └─AdaptiveAvgPool2d: 2-91           [32, 8, 1, 1]             --
│    └─Softmax: 2-92                     [32, 8, 1, 1]             --
│    └─Conv2d: 2-93                      [32, 8, 32, 32]           584
│    └─AdaptiveAvgPool2d: 2-94           [32, 8, 1, 1]             --
│    └─Sequential: 2-95                  [32, 8, 1, 1]             --
│    │    └─Conv2d: 3-124                [32, 8, 1, 1]             64
│    │    └─ReLU: 3-125                  [32, 8, 1, 1]             --
│    │    └─Conv2d: 3-126                [32, 8, 1, 1]             64
│    │    └─Sigmoid: 3-127               [32, 8, 1, 1]             --
├─Dropout2d: 1-15                        [1, 256, 32, 32]          --
├─MaxPool2d: 1-16                        [1, 256, 16, 16]          --
├─DoubleConv: 1-17                       [1, 256, 16, 16]          --
│    └─Sequential: 2-96                  [1, 512, 16, 16]          --
│    │    └─Conv2d: 3-128                [1, 512, 16, 16]          1,180,160
│    │    └─BatchNorm2d: 3-129           [1, 512, 16, 16]          1,024
│    └─Sequential: 2-97                  --                        (recursive)
│    │    └─ReLU: 3-130                  [1, 512, 16, 16]          --
│    └─Sequential: 2-98                  [1, 256, 16, 16]          --
│    │    └─Conv2d: 3-131                [1, 256, 16, 16]          1,179,904
│    │    └─BatchNorm2d: 3-132           [1, 256, 16, 16]          512
│    │    └─ReLU: 3-133                  [1, 256, 16, 16]          --
├─Dropout2d: 1-18                        [1, 256, 16, 16]          --
├─ResD_Up: 1-19                          [1, 128, 32, 32]          --
│    └─Upsample: 2-99                    [1, 256, 32, 32]          --
│    └─Conv2d: 2-100                     [1, 128, 32, 32]          65,664
│    └─Dalit_Conv: 2-101                 [1, 128, 32, 32]          --
│    │    └─Sequential: 3-134            [1, 128, 32, 32]          590,208
│    │    └─Sequential: 3-135            [1, 128, 32, 32]          147,840
│    │    └─Sequential: 3-136            [1, 128, 32, 32]          147,840
│    └─ReLU: 2-102                       [1, 128, 32, 32]          --
├─ACPNv2: 1-20                           [1, 128, 32, 32]          --
│    └─MaxPool2d: 2-103                  [1, 128, 32, 32]          --
│    └─AdaptiveAvgPool2d: 2-104          [1, 128, 1, 1]            --
│    └─Sequential: 2-105                 [1, 128, 32, 32]          --
│    │    └─DWConv: 3-137                [1, 128, 32, 32]          17,792
│    │    └─BatchNorm2d: 3-138           [1, 128, 32, 32]          256
│    │    └─ReLU: 3-139                  [1, 128, 32, 32]          --
│    └─AdaptiveAvgPool2d: 2-106          [1, 128, 1, 1]            --
│    └─Sequential: 2-107                 [1, 128, 32, 32]          --
│    │    └─DWConv: 3-140                [1, 64, 32, 32]           9,536
│    │    └─BatchNorm2d: 3-141           [1, 64, 32, 32]           128
│    │    └─ReLU: 3-142                  [1, 64, 32, 32]           --
│    │    └─DWConv: 3-143                [1, 128, 32, 32]          8,960
│    │    └─BatchNorm2d: 3-144           [1, 128, 32, 32]          256
│    │    └─ReLU: 3-145                  [1, 128, 32, 32]          --
│    └─AdaptiveAvgPool2d: 2-108          [1, 128, 1, 1]            --
│    └─Sequential: 2-109                 [1, 128, 32, 32]          --
│    │    └─DWConv: 3-146                [1, 64, 32, 32]           9,536
│    │    └─BatchNorm2d: 3-147           [1, 64, 32, 32]           128
│    │    └─ReLU: 3-148                  [1, 64, 32, 32]           --
│    │    └─DWConv: 3-149                [1, 64, 32, 32]           4,800
│    │    └─BatchNorm2d: 3-150           [1, 64, 32, 32]           128
│    │    └─ReLU: 3-151                  [1, 64, 32, 32]           --
│    │    └─DWConv: 3-152                [1, 128, 32, 32]          8,960
│    │    └─BatchNorm2d: 3-153           [1, 128, 32, 32]          256
│    │    └─ReLU: 3-154                  [1, 128, 32, 32]          --
│    └─AdaptiveAvgPool2d: 2-110          [1, 128, 1, 1]            --
│    └─Sequential: 2-111                 [1, 512, 1, 1]            --
│    │    └─Conv2d: 3-155                [1, 128, 1, 1]            65,664
│    │    └─ReLU: 3-156                  [1, 128, 1, 1]            --
│    │    └─Conv2d: 3-157                [1, 512, 1, 1]            66,048
│    └─Sigmoid: 2-112                    [1, 512, 1, 1]            --
│    └─Sequential: 2-113                 [1, 128, 32, 32]          --
│    │    └─Conv2d: 3-158                [1, 128, 32, 32]          16,512
│    │    └─BatchNorm2d: 3-159           [1, 128, 32, 32]          256
│    │    └─ReLU: 3-160                  [1, 128, 32, 32]          --
├─Dropout2d: 1-21                        [1, 128, 32, 32]          --
├─ResD_Up: 1-22                          [1, 64, 64, 64]           --
│    └─Upsample: 2-114                   [1, 128, 64, 64]          --
│    └─Conv2d: 2-115                     [1, 64, 64, 64]           16,448
│    └─Dalit_Conv: 2-116                 [1, 64, 64, 64]           --
│    │    └─Sequential: 3-161            [1, 64, 64, 64]           147,648
│    │    └─Sequential: 3-162            [1, 64, 64, 64]           37,056
│    │    └─Sequential: 3-163            [1, 64, 64, 64]           37,056
│    └─ReLU: 2-117                       [1, 64, 64, 64]           --
├─ACPNv2: 1-23                           [1, 64, 64, 64]           --
│    └─MaxPool2d: 2-118                  [1, 64, 64, 64]           --
│    └─AdaptiveAvgPool2d: 2-119          [1, 64, 1, 1]             --
│    └─Sequential: 2-120                 [1, 64, 64, 64]           --
│    │    └─DWConv: 3-164                [1, 64, 64, 64]           4,800
│    │    └─BatchNorm2d: 3-165           [1, 64, 64, 64]           128
│    │    └─ReLU: 3-166                  [1, 64, 64, 64]           --
│    └─AdaptiveAvgPool2d: 2-121          [1, 64, 1, 1]             --
│    └─Sequential: 2-122                 [1, 64, 64, 64]           --
│    │    └─DWConv: 3-167                [1, 32, 64, 64]           2,720
│    │    └─BatchNorm2d: 3-168           [1, 32, 64, 64]           64
│    │    └─ReLU: 3-169                  [1, 32, 64, 64]           --
│    │    └─DWConv: 3-170                [1, 64, 64, 64]           2,432
│    │    └─BatchNorm2d: 3-171           [1, 64, 64, 64]           128
│    │    └─ReLU: 3-172                  [1, 64, 64, 64]           --
│    └─AdaptiveAvgPool2d: 2-123          [1, 64, 1, 1]             --
│    └─Sequential: 2-124                 [1, 64, 64, 64]           --
│    │    └─DWConv: 3-173                [1, 32, 64, 64]           2,720
│    │    └─BatchNorm2d: 3-174           [1, 32, 64, 64]           64
│    │    └─ReLU: 3-175                  [1, 32, 64, 64]           --
│    │    └─DWConv: 3-176                [1, 32, 64, 64]           1,376
│    │    └─BatchNorm2d: 3-177           [1, 32, 64, 64]           64
│    │    └─ReLU: 3-178                  [1, 32, 64, 64]           --
│    │    └─DWConv: 3-179                [1, 64, 64, 64]           2,432
│    │    └─BatchNorm2d: 3-180           [1, 64, 64, 64]           128
│    │    └─ReLU: 3-181                  [1, 64, 64, 64]           --
│    └─AdaptiveAvgPool2d: 2-125          [1, 64, 1, 1]             --
│    └─Sequential: 2-126                 [1, 256, 1, 1]            --
│    │    └─Conv2d: 3-182                [1, 64, 1, 1]             16,448
│    │    └─ReLU: 3-183                  [1, 64, 1, 1]             --
│    │    └─Conv2d: 3-184                [1, 256, 1, 1]            16,640
│    └─Sigmoid: 2-127                    [1, 256, 1, 1]            --
│    └─Sequential: 2-128                 [1, 64, 64, 64]           --
│    │    └─Conv2d: 3-185                [1, 64, 64, 64]           4,160
│    │    └─BatchNorm2d: 3-186           [1, 64, 64, 64]           128
│    │    └─ReLU: 3-187                  [1, 64, 64, 64]           --
├─Dropout2d: 1-24                        [1, 64, 64, 64]           --
├─ResD_Up: 1-25                          [1, 32, 128, 128]         --
│    └─Upsample: 2-129                   [1, 64, 128, 128]         --
│    └─Conv2d: 2-130                     [1, 32, 128, 128]         4,128
│    └─Dalit_Conv: 2-131                 [1, 32, 128, 128]         --
│    │    └─Sequential: 3-188            [1, 32, 128, 128]         36,960
│    │    └─Sequential: 3-189            [1, 32, 128, 128]         9,312
│    │    └─Sequential: 3-190            [1, 32, 128, 128]         9,312
│    └─ReLU: 2-132                       [1, 32, 128, 128]         --
├─ACPNv2: 1-26                           [1, 32, 128, 128]         --
│    └─MaxPool2d: 2-133                  [1, 32, 128, 128]         --
│    └─AdaptiveAvgPool2d: 2-134          [1, 32, 1, 1]             --
│    └─Sequential: 2-135                 [1, 32, 128, 128]         --
│    │    └─DWConv: 3-191                [1, 32, 128, 128]         1,376
│    │    └─BatchNorm2d: 3-192           [1, 32, 128, 128]         64
│    │    └─ReLU: 3-193                  [1, 32, 128, 128]         --
│    └─AdaptiveAvgPool2d: 2-136          [1, 32, 1, 1]             --
│    └─Sequential: 2-137                 [1, 32, 128, 128]         --
│    │    └─DWConv: 3-194                [1, 16, 128, 128]         848
│    │    └─BatchNorm2d: 3-195           [1, 16, 128, 128]         32
│    │    └─ReLU: 3-196                  [1, 16, 128, 128]         --
│    │    └─DWConv: 3-197                [1, 32, 128, 128]         704
│    │    └─BatchNorm2d: 3-198           [1, 32, 128, 128]         64
│    │    └─ReLU: 3-199                  [1, 32, 128, 128]         --
│    └─AdaptiveAvgPool2d: 2-138          [1, 32, 1, 1]             --
│    └─Sequential: 2-139                 [1, 32, 128, 128]         --
│    │    └─DWConv: 3-200                [1, 16, 128, 128]         848
│    │    └─BatchNorm2d: 3-201           [1, 16, 128, 128]         32
│    │    └─ReLU: 3-202                  [1, 16, 128, 128]         --
│    │    └─DWConv: 3-203                [1, 16, 128, 128]         432
│    │    └─BatchNorm2d: 3-204           [1, 16, 128, 128]         32
│    │    └─ReLU: 3-205                  [1, 16, 128, 128]         --
│    │    └─DWConv: 3-206                [1, 32, 128, 128]         704
│    │    └─BatchNorm2d: 3-207           [1, 32, 128, 128]         64
│    │    └─ReLU: 3-208                  [1, 32, 128, 128]         --
│    └─AdaptiveAvgPool2d: 2-140          [1, 32, 1, 1]             --
│    └─Sequential: 2-141                 [1, 128, 1, 1]            --
│    │    └─Conv2d: 3-209                [1, 32, 1, 1]             4,128
│    │    └─ReLU: 3-210                  [1, 32, 1, 1]             --
│    │    └─Conv2d: 3-211                [1, 128, 1, 1]            4,224
│    └─Sigmoid: 2-142                    [1, 128, 1, 1]            --
│    └─Sequential: 2-143                 [1, 32, 128, 128]         --
│    │    └─Conv2d: 3-212                [1, 32, 128, 128]         1,056
│    │    └─BatchNorm2d: 3-213           [1, 32, 128, 128]         64
│    │    └─ReLU: 3-214                  [1, 32, 128, 128]         --
├─Dropout2d: 1-27                        [1, 32, 128, 128]         --
├─Up: 1-28                               [1, 32, 256, 256]         --
│    └─Upsample: 2-144                   [1, 32, 256, 256]         --
│    └─DoubleConv: 2-145                 [1, 32, 256, 256]         --
│    │    └─Sequential: 3-215            [1, 16, 256, 256]         9,264
│    │    └─Sequential: 3-216            --                        (recursive)
│    │    └─Sequential: 3-217            [1, 32, 256, 256]         4,704
├─ACPNv2: 1-29                           [1, 32, 256, 256]         --
│    └─MaxPool2d: 2-146                  [1, 32, 256, 256]         --
│    └─AdaptiveAvgPool2d: 2-147          [1, 32, 1, 1]             --
│    └─Sequential: 2-148                 [1, 32, 256, 256]         --
│    │    └─DWConv: 3-218                [1, 32, 256, 256]         1,376
│    │    └─BatchNorm2d: 3-219           [1, 32, 256, 256]         64
│    │    └─ReLU: 3-220                  [1, 32, 256, 256]         --
│    └─AdaptiveAvgPool2d: 2-149          [1, 32, 1, 1]             --
│    └─Sequential: 2-150                 [1, 32, 256, 256]         --
│    │    └─DWConv: 3-221                [1, 16, 256, 256]         848
│    │    └─BatchNorm2d: 3-222           [1, 16, 256, 256]         32
│    │    └─ReLU: 3-223                  [1, 16, 256, 256]         --
│    │    └─DWConv: 3-224                [1, 32, 256, 256]         704
│    │    └─BatchNorm2d: 3-225           [1, 32, 256, 256]         64
│    │    └─ReLU: 3-226                  [1, 32, 256, 256]         --
│    └─AdaptiveAvgPool2d: 2-151          [1, 32, 1, 1]             --
│    └─Sequential: 2-152                 [1, 32, 256, 256]         --
│    │    └─DWConv: 3-227                [1, 16, 256, 256]         848
│    │    └─BatchNorm2d: 3-228           [1, 16, 256, 256]         32
│    │    └─ReLU: 3-229                  [1, 16, 256, 256]         --
│    │    └─DWConv: 3-230                [1, 16, 256, 256]         432
│    │    └─BatchNorm2d: 3-231           [1, 16, 256, 256]         32
│    │    └─ReLU: 3-232                  [1, 16, 256, 256]         --
│    │    └─DWConv: 3-233                [1, 32, 256, 256]         704
│    │    └─BatchNorm2d: 3-234           [1, 32, 256, 256]         64
│    │    └─ReLU: 3-235                  [1, 32, 256, 256]         --
│    └─AdaptiveAvgPool2d: 2-153          [1, 32, 1, 1]             --
│    └─Sequential: 2-154                 [1, 128, 1, 1]            --
│    │    └─Conv2d: 3-236                [1, 32, 1, 1]             4,128
│    │    └─ReLU: 3-237                  [1, 32, 1, 1]             --
│    │    └─Conv2d: 3-238                [1, 128, 1, 1]            4,224
│    └─Sigmoid: 2-155                    [1, 128, 1, 1]            --
│    └─Sequential: 2-156                 [1, 32, 256, 256]         --
│    │    └─Conv2d: 3-239                [1, 32, 256, 256]         1,056
│    │    └─BatchNorm2d: 3-240           [1, 32, 256, 256]         64
│    │    └─ReLU: 3-241                  [1, 32, 256, 256]         --
├─Dropout2d: 1-30                        [1, 32, 256, 256]         --
├─OutConv: 1-31                          [1, 4, 256, 256]          --
│    └─Conv2d: 2-157                     [1, 4, 256, 256]          132
==========================================================================================
Total params: 7,010,524
Trainable params: 7,010,524
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 11.82
==========================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 1201.71
Params size (MB): 28.04
Estimated Total Size (MB): 1230.53
==========================================================================================